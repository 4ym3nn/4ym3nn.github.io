<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.7750550c0319f5de56d916b91e642bf72a5bd09ee50b201dc2ed9db69d6177a8.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">4ym3n - Dna</title>
<meta property="og:title" content=4ym3n&#32;-&#32;Dna />
<meta name="twitter:title" content=4ym3n&#32;-&#32;Dna />
<meta itemprop="name" content=4ym3n&#32;-&#32;Dna />
<meta name="application-name" content=4ym3n&#32;-&#32;Dna />
<meta property="og:site_name" content="" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="//localhost:1313/posts/smileyctf2025/dna/" />
<link rel="canonical" href="//localhost:1313/posts/smileyctf2025/dna/" itemprop="url" />
<meta name="url" content="//localhost:1313/posts/smileyctf2025/dna/" />
<meta name="twitter:url" content="//localhost:1313/posts/smileyctf2025/dna/" />
<meta property="og:url" content="//localhost:1313/posts/smileyctf2025/dna/" />


<meta property="og:updated_time" content="2025-06-17T19:41:23&#43;01:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='//localhost:1313/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



  
    <meta name="twitter:site" content="@ayme1n_dr" />
    <meta name="twitter:creator" content="@ayme1n_dr" />

<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.147.8">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.1c6f56a6497e1d68469eb2a7efcf2b145601a94408f411014a7af5ffc3a73522.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="//localhost:1313/">
                <img src="/images/test.jpeg" alt="brand image">
            </a>
        
        
            <a href="//localhost:1313/">
                <h1>4ym3n</h1>
            </a>
        
    </h1>
    <p class="lead">
    I'm Aymen, a CTF player and reverse engineering enthusiast. I explore low-level systems, break binaries, and build secure applications.
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/tamu2025/brainrot/">brainrot</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/tamu2025/otp/">otp</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/tamu2025/xorox/">xorox</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/smileyctf2025/dna/">Dna</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/apocalypse-htb/gateway/">Rev/gateway</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
            
                
                
            
                
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/4ym3nn">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://www.linkedin.com/in/aymen-drid-36bba4243/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="X" href="https://x.com/ayme1n_dr">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.1em" height="1.1em" viewBox="0 0 512 472.799">
            <path fill="currentColor" d="M403.229 0h78.506L310.219 196.04 512 462.799H354.002L230.261 301.007 88.669 462.799h-78.56l183.455-209.683L0 0h161.999l111.856 147.88L403.229 0zm-27.556 415.805h43.505L138.363 44.527h-46.68l283.99 371.278z"/>
        </svg>
    </a>





    <a target="_blank" class="social" title="Discord" href="https://discord.com/users/1235993289933455481">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"/>
        </svg>
    </a>






    <a target="_blank" class="social" title="Telegram" href="https://t.me/Aymen_dr1">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19c-.14.75-.42 1-.68 1.03c-.58.05-1.02-.38-1.58-.75c-.88-.58-1.38-.94-2.23-1.5c-.99-.65-.35-1.01.22-1.59c.15-.15 2.71-2.48 2.76-2.69a.2.2 0 0 0-.05-.18c-.06-.05-.14-.03-.21-.02c-.09.02-1.49.95-4.22 2.79c-.4.27-.76.41-1.08.4c-.36-.01-1.04-.2-1.55-.37c-.63-.2-1.12-.31-1.08-.66c.02-.18.27-.36.74-.55c2.92-1.27 4.86-2.11 5.83-2.51c2.78-1.16 3.35-1.36 3.73-1.36c.08 0 .27.02.39.12c.1.08.13.19.14.27c-.01.06.01.24 0 .38z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="RSS Feed" href="/posts/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>


    <a target="_blank" class="social" title="Email" href="mailto:aymendridforwork@gmail.com">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>




        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="//localhost:1313/posts/smileyctf2025/dna/">Dna</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2025-06-17T19:41:23&#43;0100" class="post-date">
        June 17, 2025
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>29 mins read</span>
      </span>
    </div>

    
  </div>

  
  

  
</div>

  <h1 id="smileyctf2025-">smileyCTF2025 :</h1>
<h2 id="revdna">rev/DNA</h2>
<p><img src="./challenge.png" alt="image"></p>
<h2 id="flag--we_ought_to_start_storing_our_data_as_dna_instead">Flag : .;,;.{we_ought_to_start_storing_our_data_as_dna_instead}</h2>
<h1 id="description">Description</h1>
<p>deoxy ribo nucleic acid deoxy meaning without oxygen ribo meaning the 5-carbon sugar backbone nucleic meaning of the nucleus acid meaning proton donor</p>
<h1 id="solution">Solution</h1>
<h2 id="initial-recon">Initial Recon</h2>
<p>We start by looking at the challenge directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜  dna ls
</span></span><span style="display:flex;"><span>main.cpython-310.pyc  vm.dna
</span></span><span style="display:flex;"><span>➜  dna 
</span></span></code></pre></div><p>We can see that this is a virtual machine challenge, and the Python code has been compiled with Python 3.10 into a .pyc file ,Before diving into the challenge, let&rsquo;s take a moment to understand what a virtual machine (VM) is.</p>
<h3 id="what-is-a-vm">What Is A VM?</h3>
<p>VM is short form of Virtual Machine. A virtual machine is exactly what it’s name is, it’s virtual!.</p>
<p>An example of physical machine is your CPU. Your CPU is executing real instructions. When you do a mov instruction, your CPU will take minimum number of steps to complete that instruction. That instruction will have effect on real registers and memory.</p>
<p>When it comes to a virtual CPU (machine), it may or may not have a move instruction in the first place! Even if it has a mov instruction, it’ll be moving data to/from variables declared within the program. So the virtual cpu doesn’t directly use anything real (registers/memory) and all the resources that it’ll use will be stored in a variable that is already allocated on either the stack or the heap. All the (virtual) instructions that a virtual machine will run will ultimately be converted to machine code. Because of this conversion, a virtual CPU takes much more number of steps than a physical CPU to execute a single (virtual) instruction and because of this, virtual machines are slower too.</p>
<h3 id="how-do-virtual-machines-work">How Do Virtual Machines Work?</h3>
<p>Since a virtual machine is trying to emulate some new instruction set, it’ll need to have a CPU that will be able to decode those set of instructions and for that all virtual machines implement their own virtual CPU. How do we do that? Well, a CPU is just a bunch of registers and some helper units.</p>
<p><img src="./abasiccomputer.gif" alt="image"></p>
<p>A virtual CPU is much similar to a physical CPU. It’ll have it’s own set of registers and cache and all. A simple implementation in code will look something like this</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RegID</span>(IntEnum):
</span></span><span style="display:flex;"><span>    RAX <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    RBX <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    RCX <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Add other registers as needed</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CPU</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, num_registers: int, code_size: int):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>registers: List[int] <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> num_registers  <span style="color:#75715e"># X registers</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>stack: List[int] <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>pc: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>  <span style="color:#75715e"># Program counter</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>bytecode: List[int] <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> code_size
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>code_sz: int <span style="color:#f92672">=</span> code_size
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Additional VM components can go here</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># e.g., flags, memory, etc.</span>
</span></span></code></pre></div><p>This makes up the structure of our CPU, but then how will it execute instructions? Normally, challenge developers write their program in a symbolic language and then convert it to the virtual CPUs assembly code. This assembled code is what we refer to as the bytecode. It’s just an array of numbers like the opcodes of your actual CPU.</p>
<p>This bytecode is then read and passed to a Fetch, Decode, Execute (FeDeX) loop. This loop does what it’s name is. It fetches the current instruction from bytecode, decodes what it means (useful part) and then executes it! This is very much similar to what an actual CPU does but this decoding part makes up the extra steps that our virtual CPU has to take.</p>
<h3 id="the-fedex-loop">The FeDeX Loop</h3>
<p>In normal CPU, there is a register called the program counter (instruction pointer in Intel CPUs). This register contains an absolute address or an offset from a base address that directly or indirectly points to the next instruction that needs to be executed. So, the fetch part just needs to keep track of this program counter. To fetch the next instruction, the program will do</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> pc <span style="color:#f92672">&lt;</span> len(code):
</span></span><span style="display:flex;"><span>    opcode, operand <span style="color:#f92672">=</span> map(trans, [code[pc:pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>], code[pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>:pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]])
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># fetch current instruction </span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">match</span> opcode:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># decode</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># execute</span>
</span></span><span style="display:flex;"><span>            s<span style="color:#f92672">.</span>append(operand)
</span></span><span style="display:flex;"><span>            pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">12</span>
</span></span></code></pre></div><p>this is where the interesting part comes : In all normal, not crazy VMs you’ll find a FeDeX loop like this one. This function is what we need to find if it’s a VM challenge. Generally it’s easy to find because of the code structure here! When you’ll see this code in a graph like format, you’ll notice that almost all similar VMs (with a FeDeX loop) will have similar structure. Let’s try that in this crackme.</p>
<h3 id="starting-with-the-challenge">Starting with the Challenge</h3>
<p>To decompile the .pyc file back into Python source code, I used pylingual.io.
and this was the result :</p>
<p><a href="./vm.py">main.py</a></p>
<h3 id="virtual-machine-overview">Virtual Machine Overview</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> marshal
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>nm <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">3</span>}
</span></span><span style="display:flex;"><span>unlucky <span style="color:#f92672">=</span> [<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x8c</span><span style="color:#e6db74">oooooooooooonooolooo,ooo</span><span style="color:#ae81ff">\x9c</span><span style="color:#e6db74">Sooo</span><span style="color:#ae81ff">\x06</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x12</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">nvo</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">mSo</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">lvo</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">nSo</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">kvo</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">lSo</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">mvo</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">kSo</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0e</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">o&lt;oFj!</span><span style="color:#ae81ff">\xb5</span><span style="color:#e6db74">n;</span><span style="color:#ae81ff">\xb5</span><span style="color:#e6db74">n.</span><span style="color:#ae81ff">\xb5</span><span style="color:#e6db74">n(</span><span style="color:#ae81ff">\xb5</span><span style="color:#e6db74">n,</span><span style="color:#ae81ff">\xc6</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\xb5</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\x01\x02\xc6</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\xb5</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\x1b\x02\x1f\xc6</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">eooo</span><span style="color:#ae81ff">\x95</span><span style="color:#e6db74">fS</span><span style="color:#ae81ff">\x1a\x01\x03\x1a\x0c\x04\x16</span><span style="color:#e6db74">Q</span><span style="color:#ae81ff">\xb5</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x1a\x01\x03\x1a\x0c\x04\x16</span><span style="color:#e6db74">booo</span><span style="color:#ae81ff">\x9c</span><span style="color:#e6db74">coookmcncncncngn&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x96</span><span style="color:#e6db74">uuuuuuuuuuuuruuu}uuu6uuu</span><span style="color:#ae81ff">\x86\x11</span><span style="color:#e6db74">uuu</span><span style="color:#ae81ff">\x11</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\x11</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x11</span><span style="color:#e6db74">v</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x11</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\x11</span><span style="color:#e6db74">p</span><span style="color:#ae81ff">\xf1</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">u1u</span><span style="color:#ae81ff">\xf6</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">v</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">v1u(n</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\xd5</span><span style="color:#e6db74">v</span><span style="color:#ae81ff">\xd4</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\xf6</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\xf6</span><span style="color:#e6db74">t1u(e)w</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">p</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">v</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">spulu</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">pluluMuvuIu</span><span style="color:#ae81ff">\x04</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x04</span><span style="color:#e6db74">g</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">v</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x11</span><span style="color:#e6db74">u&amp;u</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">s;</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">q426!</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">q!642</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">q6!24</span><span style="color:#ae81ff">\x16</span><span style="color:#e6db74">tuuuuuuuuuuuwuuusuuu&amp;uuu</span><span style="color:#ae81ff">\x86</span><span style="color:#e6db74">ouuu</span><span style="color:#ae81ff">\x1c</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">u(|</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\xd5</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\xd4</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\xf6</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\xe6</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x04</span><span style="color:#e6db74">w&amp;u</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\xdc</span><span style="color:#e6db74">v</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">v</span><span style="color:#ae81ff">\x06\x00\x18\xaf</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x1b\x18\xaf</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\x03\x14\x19\x00\x10\x06\xdc</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">w[E</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x16\xdc</span><span style="color:#e6db74">u</span><span style="color:#ae81ff">\x07</span><span style="color:#e6db74">xuuu</span><span style="color:#ae81ff">\x8f</span><span style="color:#e6db74">|I</span><span style="color:#ae81ff">\x00\x1b\x19\x00\x16\x1e\x0c</span><span style="color:#e6db74">K</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">r</span><span style="color:#ae81ff">\x00\x1b\x19\x00\x16\x1e\x0c</span><span style="color:#e6db74">nuuu</span><span style="color:#ae81ff">\x86</span><span style="color:#e6db74">wuuuou</span><span style="color:#ae81ff">\x8f</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x00\x1b\x19\x00\x16\x1e\x0c</span><span style="color:#e6db74">*G[I</span><span style="color:#ae81ff">\x19\x1a\x16\x14\x19\x06</span><span style="color:#e6db74">K[I</span><span style="color:#ae81ff">\x11\x1c\x16\x01\x16\x1a\x18\x05</span><span style="color:#e6db74">K</span><span style="color:#ae81ff">\xdc</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">|</span><span style="color:#ae81ff">\x10\x1b\x00\x18\x10\x07\x14\x01\x10\xaf</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\x06\x1a\x07\x01\x10\x11\x07</span><span style="color:#e6db74">}uuu</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\x1e\x10\x0c\x06\xdc</span><span style="color:#e6db74">r</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x06</span><span style="color:#e6db74">D</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x06</span><span style="color:#e6db74">G</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">w</span><span style="color:#ae81ff">\x06</span><span style="color:#e6db74">F</span><span style="color:#ae81ff">\xaf</span><span style="color:#e6db74">v</span><span style="color:#ae81ff">\x01\x18\x05\xaf</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x06\xaf</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x1c\x07</span><span style="color:#e6db74">yuuu</span><span style="color:#ae81ff">\x07</span><span style="color:#e6db74">xuuu</span><span style="color:#ae81ff">\x07</span><span style="color:#e6db74">xuuu</span><span style="color:#ae81ff">\x07</span><span style="color:#e6db74">{uuu</span><span style="color:#ae81ff">\x07</span><span style="color:#e6db74">zuuucuuu</span><span style="color:#ae81ff">\x86</span><span style="color:#e6db74">guuuqwqtqt{t{tmtotw</span><span style="color:#ae81ff">\x8a</span><span style="color:#e6db74">}w&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x8a</span><span style="color:#e6db74">iiiiiiiiiiiihiiiniiijiii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">/iii</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xe0</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xe1</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xed</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">hhi.i</span><span style="color:#ae81ff">\xee</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x0f</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\xed</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">i:i@n&#39;</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x1b\x08\x07\r\x06\x04\xb3</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x0f\x1c\x07\n\x1d\x06\x06\x05\x1a\n</span><span style="color:#e6db74">kiiiiiiiiiiikiiikiii:iii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">aiii</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">h(i:i@h&#39;</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x11\xb3</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x10\x1b</span><span style="color:#e6db74">liii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">liii</span><span style="color:#ae81ff">\x93</span><span style="color:#e6db74">`U</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">W</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">Miii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">kiiiai</span><span style="color:#ae81ff">\x93</span><span style="color:#e6db74">r</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">6ZGU</span><span style="color:#ae81ff">\x05\x06\n\x08\x05\x1a</span><span style="color:#e6db74">WGU</span><span style="color:#ae81ff">\x05\x08\x04\x0b\r\x08</span><span style="color:#e6db74">W</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">iiiiiiiiiiiiiiiijiiiiiii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">Ciii</span><span style="color:#ae81ff">\x0c</span><span style="color:#e6db74">i3h</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">i3k</span><span style="color:#ae81ff">\xee</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xee</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x0f</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xed</span><span style="color:#e6db74">a3j</span><span style="color:#ae81ff">\xee</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x0f</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xed</span><span style="color:#e6db74">a3m</span><span style="color:#ae81ff">\xee</span><span style="color:#e6db74">imi3l:i@l</span><span style="color:#ae81ff">\x93</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">6ZGU</span><span style="color:#ae81ff">\x05\x06\n\x08\x05\x1a</span><span style="color:#e6db74">WG</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10\n</span><span style="color:#e6db74">kiiiiiiiiiiimiiiliiiziii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">-iii</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">hhi</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xe1</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">hhi</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h-i4e</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">jpipi</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">jpiUi</span><span style="color:#ae81ff">\x18</span><span style="color:#e6db74">z</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">i:i@j&#39;</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">m(*.=</span><span style="color:#ae81ff">\x80</span><span style="color:#e6db74">miii</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\x1a\x1c\x19\x0c\x1b\xb3</span><span style="color:#e6db74">a66</span><span style="color:#ae81ff">\x00\x07\x00\x1d</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\x05\x00\x1a\x1d\xb3</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\x1a\x01\x1c\x0f\x0f\x05\x0c\xb3</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\x1b\x08\x07\x0e\x0c\xc0</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\x1a\x0c\x05\x0f\xb3</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\x04\x08\x19\x19\x00\x07\x0e\xb3</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\x02\x0c\x10\x1a\xb3</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x00\xc0</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">`66</span><span style="color:#ae81ff">\n\x05\x08\x1a\x1a</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x1b\x1b</span><span style="color:#e6db74">liii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">`iii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">ciiiOiii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">eiiiehahcheh</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">hm</span><span style="color:#ae81ff">\x96\x93</span><span style="color:#e6db74">J</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">6ZGU</span><span style="color:#ae81ff">\x05\x06\n\x08\x05\x1a</span><span style="color:#e6db74">WG</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">G66</span><span style="color:#ae81ff">\x00\x07\x00\x1d</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">kiiiiiiiiiiiliiiliiiziii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">;iii</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">j`i</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xee</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x0f</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\xed</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\xec</span><span style="color:#e6db74">kpi-i</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">A</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xc9</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\xe1</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">h:i</span><span style="color:#ae81ff">\x18</span><span style="color:#e6db74">`@a&#39;</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">kiii</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\x01\x08\x1a\x01\x05\x00\x0b</span><span style="color:#e6db74">=</span><span style="color:#ae81ff">\x80</span><span style="color:#e6db74">Iiii</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">hiiiiiiiiiiikiiimiiiZiii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">uiii</span><span style="color:#ae81ff">\xe8</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">i4`</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xe1</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xea</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x02</span><span style="color:#e6db74">k?ihi</span><span style="color:#ae81ff">\x18</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">i:i@h&#39;</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\x06\x1b\r\xc0</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">kGY</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">niii</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\x02\x0c\x10\x1b</span><span style="color:#e6db74">liii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">`iii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">ciii[iii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">miiik</span><span style="color:#ae81ff">\xe9</span><span style="color:#e6db74">si</span><span style="color:#ae81ff">\x93</span><span style="color:#e6db74">P</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">6ZGU</span><span style="color:#ae81ff">\x05\x06\n\x08\x05\x1a</span><span style="color:#e6db74">WG</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">G66</span><span style="color:#ae81ff">\x0e\x0c\x1d\x00\x1d\x0c\x04</span><span style="color:#e6db74">66GU</span><span style="color:#ae81ff">\x05\x06\n\x08\x05\x1a</span><span style="color:#e6db74">WGU</span><span style="color:#ae81ff">\x0e\x0c\x07\x0c\x11\x19\x1b</span><span style="color:#e6db74">W</span><span style="color:#ae81ff">\x80</span><span style="color:#e6db74">hiii</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">c66</span><span style="color:#ae81ff">\x00\x04\x19\x06\x1b\x1d</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x1b\x08\x07\r\x0b\x10\x1d\x0c\x1a\xb3</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\x08\x05\x05\xb3</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x1a\x01\x08</span><span style="color:#e6db74">[</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">_</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\r\x00\x0e\x0c\x1a\x1d\x1b</span><span style="color:#e6db74">ziii</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">b66</span><span style="color:#ae81ff">\x0e\x0c\x1d\x00\x1d\x0c\x04</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">l</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">piii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">Biii</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\x01\x05\x00\x0b\xb3</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\x1b\x05\x00\x0b\xb3</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x0b\xc0</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">wiii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">Ciii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">`iii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">ciiiDiii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">giiiahahkhchAhehk</span><span style="color:#ae81ff">\x94\x93</span><span style="color:#e6db74">O</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">6ZGU</span><span style="color:#ae81ff">\x05\x06\n\x08\x05\x1a</span><span style="color:#e6db74">WG</span><span style="color:#ae81ff">\x1c\x07\x05\x1c\n\x02\x10</span><span style="color:#e6db74">G66</span><span style="color:#ae81ff">\x0e\x0c\x1d\x00\x1d\x0c\x04</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">a66</span><span style="color:#ae81ff">\x07\x08\x04\x0c</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">c66</span><span style="color:#ae81ff">\x04\x06\r\x1c\x05\x0c</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">e66</span><span style="color:#ae81ff">\x18\x1c\x08\x05\x07\x08\x04\x0c</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">}iii</span><span style="color:#ae81ff">\x1b\\</span><span style="color:#e6db74">iii</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">d66</span><span style="color:#ae81ff">\n\x05\x08\x1a\x1a\n\x0c\x05\x05</span><span style="color:#e6db74">66</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">liii</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">viii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">Siii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">`iii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">ciiiLiii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">oiiiaigh}n</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">ciii</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">Yiii</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\x1a\x0c\x0c\r\xb3</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x1b\x0c\r\x1c\n\x0c\xb3</span><span style="color:#e6db74">k</span><span style="color:#ae81ff">\x07\x04\xb3</span><span style="color:#e6db74">o</span><span style="color:#ae81ff">\x1f\x08\x05\x1c\x0c\x1a\xb3</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\r\x00\n\x1d\xc0</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">ciii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">liii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">+iii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">`iii</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">ciiiHiii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">aiiiakwh}hey&#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x82</span><span style="color:#e6db74">aaaaaaaaaaaacaaagaaa&#34;aaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">]aaa&amp;a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\xe5</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\xe2</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\x1c</span><span style="color:#e6db74">a&amp;a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\xe5</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\xec</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x1c</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">g</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\xe2</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\xfa</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">f</span><span style="color:#ae81ff">\xfc</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\xe2</span><span style="color:#e6db74">``a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">a2aHi/</span><span style="color:#ae81ff">\x02</span><span style="color:#e6db74">aaaaaaaaaaaaaaaabaaaaaaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">Iaaa</span><span style="color:#ae81ff">\x04</span><span style="color:#e6db74">a;`</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">a;c</span><span style="color:#ae81ff">\xe6</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x07</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\xe5</span><span style="color:#e6db74">i;b</span><span style="color:#ae81ff">\xe6</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x07</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\xe5</span><span style="color:#e6db74">i;e</span><span style="color:#ae81ff">\xe6</span><span style="color:#e6db74">aea;d2aHd</span><span style="color:#ae81ff">\x9b</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x14\x0f\r\x14\x02\n\x18</span><span style="color:#e6db74">&gt;UO]</span><span style="color:#ae81ff">\r\x0e\x02\x00\r\x12</span><span style="color:#e6db74">_O,,</span><span style="color:#ae81ff">\x02</span><span style="color:#e6db74">eaaaaaaaaaaaeaaagaaaraaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">saaa</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\xe2</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\xc1</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">e2aH`/</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\x12\x14\x11\x04\x13\xbb</span><span style="color:#e6db74">f&gt;&gt;</span><span style="color:#ae81ff">\x0f\x04\x16</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\x02\r\x12\xbb</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x0f\x00\x0c\x04\xbb</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\x03\x00\x12\x04\x12\xbb</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\x05\x02\x15\xc8</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">h&gt;&gt;</span><span style="color:#ae81ff">\x02\r\x00\x12\x12</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x9b</span><span style="color:#e6db74">h]</span><span style="color:#ae81ff">\x14\x0f\r\x14\x02\n\x18</span><span style="color:#e6db74">_</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">f</span><span style="color:#ae81ff">\x14\x0f\r\x14\x02\n\x18</span><span style="color:#e6db74">Zaaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">caaas`</span><span style="color:#ae81ff">\x9b</span><span style="color:#e6db74">|</span><span style="color:#ae81ff">\x14\x0f\r\x14\x02\n\x18</span><span style="color:#e6db74">&gt;UO]</span><span style="color:#ae81ff">\r\x0e\x02\x00\r\x12</span><span style="color:#e6db74">_O,,O&gt;&gt;</span><span style="color:#ae81ff">\x0f\x04\x16</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\x02</span><span style="color:#e6db74">`aaaaaaaaaaafaaadaaa~aaa</span><span style="color:#ae81ff">\x92\x05</span><span style="color:#e6db74">aaa</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\xe2</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x08</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\xc5</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\xef</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x1c</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\xc1</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\xe2</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x1c</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\xe4</span><span style="color:#e6db74">bxa</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\xe4</span><span style="color:#e6db74">bxava</span><span style="color:#ae81ff">\x1c</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x15</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\xc1</span><span style="color:#e6db74">g</span><span style="color:#ae81ff">\xc0</span><span style="color:#e6db74">a</span><span style="color:#ae81ff">\xe2</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\xe2</span><span style="color:#e6db74">`</span><span style="color:#e6db74">%a</span><span style="color:#e6db74">&lt;k=c</span><span style="color:#ae81ff">\x1c</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\x1c</span><span style="color:#e6db74">g</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">dxa</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">g]a</span><span style="color:#ae81ff">\x10</span><span style="color:#e6db74">D</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">b2aHb/</span><span style="color:#ae81ff">\x88</span><span style="color:#e6db74">caaa</span><span style="color:#ae81ff">\x88</span><span style="color:#e6db74">`aaa</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">f</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">gaaa</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">i&gt;&gt;</span><span style="color:#ae81ff">\x02\x00\r\r</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\r\x08\x12\x15\xbb</span><span style="color:#e6db74">g</span><span style="color:#ae81ff">\x17\x00\r\x14\x04\x12\xbb</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x04\x0f\x14\x0c\x04\x13\x00\x15\x04\xbb</span><span style="color:#e6db74">g</span><span style="color:#ae81ff">\x12\x0e\x13\x15\x04\x05\xbb</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\n\x04\x18\x12\xc8</span><span style="color:#e6db74">f</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">haaa</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x00\x13\x06\x12\xbb</span><span style="color:#e6db74">g</span><span style="color:#ae81ff">\n\x16\x00\x13\x06\x12\xbb</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\x08\x0f\x12\x15\x00\x0f\x02\x04\xbb</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x17\x00\r\x12\xbb</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\x08\xbb</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\n\x13</span><span style="color:#e6db74">laaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">naaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">qaaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">paaa_aaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">maaas`m`}`y`o`e`</span><span style="color:#ae81ff">\x9b\x7f\x14\x0f\r\x14\x02\n\x18</span><span style="color:#e6db74">&gt;UO]</span><span style="color:#ae81ff">\r\x0e\x02\x00\r\x12</span><span style="color:#e6db74">_O,,O&gt;&gt;</span><span style="color:#ae81ff">\x02\x00\r\r</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">g</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">i&gt;&gt;</span><span style="color:#ae81ff">\x0f\x00\x0c\x04</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">k&gt;&gt;</span><span style="color:#ae81ff">\x0c\x0e\x05\x14\r\x04</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">m&gt;&gt;</span><span style="color:#ae81ff">\x10\x14\x00\r\x0f\x00\x0c\x04</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">faaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">yaaa</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">l&gt;&gt;</span><span style="color:#ae81ff">\x02\r\x00\x12\x12\x02\x04\r\r</span><span style="color:#e6db74">&gt;&gt;</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">naaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">naaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">laaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">qaaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">paaa[aaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">gaaaiam`ub</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">c,,</span><span style="color:#ae81ff">\x02</span><span style="color:#e6db74">aaaaaaaaaaaaaaaa`aaa!aaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">maaa</span><span style="color:#ae81ff">\x04</span><span style="color:#e6db74">a;`</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">a;c</span><span style="color:#ae81ff">\x05</span><span style="color:#e6db74">`2aHc</span><span style="color:#ae81ff">\x9b</span><span style="color:#e6db74">t</span><span style="color:#ae81ff">\x14\x0f\r\x14\x02\n\x18</span><span style="color:#e6db74">&gt;UO]</span><span style="color:#ae81ff">\r\x0e\x02\x00\r\x12</span><span style="color:#e6db74">_O,%/</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">Iaaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">Haaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">Kaaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">naaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">naaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">naaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">qaaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">paaa</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">aaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">eaaaiae`</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">c,%</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">`</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">h</span><span style="color:#ae81ff">\x0c\x04\x15\x00\x02\r\x00\x12\x12\x9b</span><span style="color:#e6db74">@</span><span style="color:#ae81ff">\x06\r\x0e\x03\x00\r\x12</span><span style="color:#e6db74">IH:F</span><span style="color:#ae81ff">\x0f\x14\x02\r\x04\x0e\x15\x08\x05\x04</span><span style="color:#e6db74">&gt;</span><span style="color:#ae81ff">\x0c\x00\x11</span><span style="color:#e6db74">F&lt;A</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">A,%I</span><span style="color:#ae81ff">\x9b</span><span style="color:#e6db74">`H</span><span style="color:#ae81ff">\xc8</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x15\x18\x11\x04\xbb</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x05\x08\x02\x15\xbb</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\x04\x19\x04\x02\xbb</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\x0f\x0c\xc8</span><span style="color:#e6db74">c</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">Laaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">Saaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">naaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">naaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">qaaa</span><span style="color:#ae81ff">\x13</span><span style="color:#e6db74">paaaVaaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">gaaaqbumyb&#39;</span>]
</span></span><span style="display:flex;"><span>trans <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> s: sum((nm[c] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> i <span style="color:#66d9ef">for</span> i, c <span style="color:#f92672">in</span> enumerate(s)))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv)<span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>    opcodent(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Usage: </span><span style="color:#e6db74">{</span>sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74"> &lt;dna_file&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>code <span style="color:#f92672">=</span> open(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;&gt; &#39;</span>)<span style="color:#f92672">.</span>encode()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(flag)<span style="color:#f92672">!=</span> <span style="color:#ae81ff">56</span>:
</span></span><span style="display:flex;"><span>    exit(<span style="color:#e6db74">&#39;WRONG!&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> flag[:<span style="color:#ae81ff">6</span>]<span style="color:#f92672">!=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;.;,;.{&#39;</span>:
</span></span><span style="display:flex;"><span>    exit(<span style="color:#e6db74">&#39;WRONG!&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> flag[(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)]<span style="color:#f92672">!=</span> <span style="color:#ae81ff">125</span>:
</span></span><span style="display:flex;"><span>    exit(<span style="color:#e6db74">&#39;WRONG!&#39;</span>)
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">6</span>:(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(flag)):
</span></span><span style="display:flex;"><span>    m[<span style="color:#ae81ff">640</span> <span style="color:#f92672">+</span> i] <span style="color:#f92672">=</span> flag[i]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>pc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>The code defines two key data structures:</p>
<pre><code>s: An array used internally by the VM as stack (we’ll understand why later).
    
m: A dictionary that serves as memory for the virtual machine.
</code></pre>
<h4 id="dna-code-representation">DNA Code Representation</h4>
<p>The virtual machine reads a DNA-like string from a file, which consists only of the characters {A, T, G, C}. Here&rsquo;s an example:</p>
<p><code>GAAAAGGAAAAAAAGGGTAAAAAAGTGATAAGGAAAAAAACGTAAAAAAAGTGAGAAGGAAAAAAAACAGAAAAAAGTGACAAGGAAAAAAAGGAGAAAAAAGTGAATAGGAAAAAAAACGTAAAAAA...</code></p>
<p>To decode these characters into numbers, a simple base-4 mapping is used:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>nm <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">3</span>}
</span></span></code></pre></div><p>This mapping turns each DNA character into a digit between 0 and 3.
DNA to Integer Conversion</p>
<p>The VM uses the following trans lambda function to convert short DNA strings into integers:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>trans <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> s: sum((nm[c] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> i <span style="color:#66d9ef">for</span> i, c <span style="color:#f92672">in</span> enumerate(s)))
</span></span></code></pre></div><p>This treats the DNA string as a little-endian base-4 number.</p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>trans(<span style="color:#e6db74">&#39;AT&#39;</span>) <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>
</span></span></code></pre></div><h4 id="the-unlucky-list">The unlucky List</h4>
<p>The <code>unlucky</code> list contains 4 elements, each being a long bytes object with repetitive patterns at the beginning (<code>ooo...</code>, <code>uuu...</code>, <code>iii...</code>, <code>aaa...</code>). Initially, it&rsquo;s unclear what these represent.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>unlucky <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x8c</span><span style="color:#e6db74">oooooooooooonooolooo,ooo</span><span style="color:#ae81ff">\x9c</span><span style="color:#e6db74">Sooo...&#39;</span>,  <span style="color:#75715e"># Element 0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x96</span><span style="color:#e6db74">uuuuuuuuuuuuruuu}uuu6uuu</span><span style="color:#ae81ff">\x86\x11</span><span style="color:#e6db74">uuu...&#39;</span>,  <span style="color:#75715e"># Element 1  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x8a</span><span style="color:#e6db74">iiiiiiiiiiiihiiiniiijiii</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">/iii...&#34;</span>,  <span style="color:#75715e"># Element 2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x82</span><span style="color:#e6db74">aaaaaaaaaaaacaaagaaa&#34;aaa</span><span style="color:#ae81ff">\x92</span><span style="color:#e6db74">]aaa...&#39;</span>   <span style="color:#75715e"># Element 3</span>
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>When we examine its usage in case 13, the purpose becomes clear:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">13</span>:  <span style="color:#75715e"># CALL_SNIPPET</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> s:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    key <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop()                    <span style="color:#75715e"># Get decryption key from stack</span>
</span></span><span style="display:flex;"><span>    print(m[<span style="color:#ae81ff">666</span>])
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Key: </span><span style="color:#e6db74">{</span>key<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># XOR decrypt with the key</span>
</span></span><span style="display:flex;"><span>    decrypted_bytes <span style="color:#f92672">=</span> bytes([b <span style="color:#f92672">^</span> key <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> unlucky<span style="color:#f92672">.</span>pop(<span style="color:#ae81ff">0</span>)])
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Convert decrypted bytes to Python code object</span>
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>__code__ <span style="color:#f92672">=</span> marshal<span style="color:#f92672">.</span>loads(decrypted_bytes)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Execute the hidden code</span>
</span></span><span style="display:flex;"><span>    f()
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><p>The key insight is the use of <code>marshal.loads()</code> on the decrypted bytes and its assignment to <code>f.__code__</code>. This pattern strongly suggests that the <code>unlucky</code> list contains XOR-encrypted Python bytecode. The repetitive patterns at the beginning of each element are likely artifacts of this XOR encryption process.</p>
<ol>
<li>Popping a decryption key from the execution stack</li>
<li>XOR decrypting each byte in the current unlucky element with this key</li>
<li>Using <code>marshal.loads()</code> to convert the decrypted bytes back into Python bytecode</li>
<li>Dynamically executing the revealed code by replacing a dummy function&rsquo;s bytecode</li>
</ol>
<p>This is a sophisticated obfuscation technique that hides the actual program logic until runtime. The <code>marshal.loads()</code> → <code>f.__code__</code> pattern clearly indicates we&rsquo;re dealing with compiled Python bytecode rather than just encrypted data. Each of the 4 elements likely contains a different stage of the program&rsquo;s execution, consumed sequentially via <code>unlucky.pop(0)</code>.</p>
<h4 id="input-validation-and-setup">Input Validation and Setup</h4>
<p>The program expects a DNA code file as an argument. It reads the file and prompts the user for a flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Usage: </span><span style="color:#e6db74">{</span>sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74"> &lt;dna_file&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>code <span style="color:#f92672">=</span> open(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;&gt; &#39;</span>)<span style="color:#f92672">.</span>encode()
</span></span></code></pre></div><h4 id="flag-validation">Flag Validation</h4>
<p>The flag must meet strict format requirements:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(flag) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">56</span>:
</span></span><span style="display:flex;"><span>    exit(<span style="color:#e6db74">&#39;WRONG!&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> flag[:<span style="color:#ae81ff">6</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;.;,;.{&#39;</span>:
</span></span><span style="display:flex;"><span>    exit(<span style="color:#e6db74">&#39;WRONG!&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> flag[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">125</span>:  <span style="color:#75715e"># ASCII code for &#39;}&#39;</span>
</span></span><span style="display:flex;"><span>    exit(<span style="color:#e6db74">&#39;WRONG!&#39;</span>)
</span></span></code></pre></div><p>After validation, the wrapper format is stripped, leaving 49 bytes of core flag data:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> flag[<span style="color:#ae81ff">6</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span></code></pre></div><h4 id="storing-the-flag-in-vm-memory">Storing the Flag in VM Memory</h4>
<p>Each byte of the flag is stored in the virtual memory dictionary m, starting at address 640:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(flag)):
</span></span><span style="display:flex;"><span>    m[<span style="color:#ae81ff">640</span> <span style="color:#f92672">+</span> i] <span style="color:#f92672">=</span> flag[i]
</span></span></code></pre></div><h3 id="beginning-execution">Beginning Execution</h3>
<p>The virtual machine sets the program counter (pc) to 0 and begins a decode-execute loop:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> pc <span style="color:#f92672">&lt;</span> len(code):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Each instruction is 12 DNA characters:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#   - First 2 characters: opcode</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#   - Next 10 characters: operand</span>
</span></span><span style="display:flex;"><span>    opcode, operand <span style="color:#f92672">=</span> map(trans, [code[pc:pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>], code[pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>:pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]])
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span></code></pre></div><h3 id="opcode-interpretation">Opcode Interpretation</h3>
<h4 id="push--opcode-0">PUSH — Opcode 0</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">0</span>:  <span style="color:#75715e"># PUSH</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Push operand onto the stack</span>
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>append(operand)
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">12</span>
</span></span></code></pre></div><p><strong>and here we confirm that s is the stack</strong></p>
<h4 id="pop--opcode-1">POP — Opcode 1</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">1</span>:  <span style="color:#75715e"># POP</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Remove the top element from the stack</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> s:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="load--opcode-2">LOAD — Opcode 2</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">2</span>:  <span style="color:#75715e"># LOAD from memory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Push value at memory[operand] onto the stack</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> operand <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> m:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Uninitialized memory access at </span><span style="color:#e6db74">{</span>operand<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>append(m[operand])
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">12</span>
</span></span></code></pre></div><h4 id="store--opcode-3">STORE — Opcode 3</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">3</span>:  <span style="color:#75715e"># STORE to memory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Pop top of stack and store at memory[operand]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> s:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    m[operand] <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">12</span>
</span></span></code></pre></div><h4 id="add--opcode-4">ADD — Opcode 4</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">4</span>:  <span style="color:#75715e"># ADD</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Pop two values, push their sum</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(s) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    a, b <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop(), s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>append(a <span style="color:#f92672">+</span> b)
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="sub--opcode-5">SUB — Opcode 5</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">5</span>:  <span style="color:#75715e"># SUB</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Pop two values, push b - a</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(s) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    a, b <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop(), s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>append(b <span style="color:#f92672">-</span> a)
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="mul--opcode-6">MUL — Opcode 6</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">6</span>:  <span style="color:#75715e"># MUL</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Pop two values, push their product</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(s) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    a, b <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop(), s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>append(a <span style="color:#f92672">*</span> b)
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="mod--opcode-7">MOD — Opcode 7</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">7</span>:  <span style="color:#75715e"># MOD</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Pop two values, push b % a (a must not be 0)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(s) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    a, b <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop(), s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> a <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Division by zero&#39;</span>)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>append(b <span style="color:#f92672">%</span> a)
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="equal--opcode-8">EQUAL — Opcode 8</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">8</span>:  <span style="color:#75715e"># EQUAL</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Push 1 if a == b else 0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(s) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    a, b <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop(), s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    print(a)
</span></span><span style="display:flex;"><span>    print(b)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> a <span style="color:#f92672">==</span> b <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="jmp--opcode-9">JMP — Opcode 9</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">9</span>:  <span style="color:#75715e"># JMP</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Unconditional jump to address `operand`</span>
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">=</span> operand
</span></span></code></pre></div><h4 id="jmp_if_eq_1--opcode-10">JMP_IF_EQ_1 — Opcode 10</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">10</span>:  <span style="color:#75715e"># JMP_IF_EQ_1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Conditional jump if top of stack == 1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> s:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> s<span style="color:#f92672">.</span>pop() <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        pc <span style="color:#f92672">=</span> operand
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">12</span>
</span></span></code></pre></div><h4 id="jmp_if_neq_1--opcode-11">JMP_IF_NEQ_1 — Opcode 11</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">11</span>:  <span style="color:#75715e"># JMP_IF_NEQ_1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Conditional jump if top of stack != 1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> s:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> s<span style="color:#f92672">.</span>pop() <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        pc <span style="color:#f92672">=</span> operand
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">12</span>
</span></span></code></pre></div><h4 id="print--opcode-12">PRINT — Opcode 12</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">12</span>:  <span style="color:#75715e"># PRINT</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Print character from top of stack</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> s:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    print(chr(s<span style="color:#f92672">.</span>pop()), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="call_snippet--opcode-13">CALL_SNIPPET — Opcode 13</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">13</span>:  <span style="color:#75715e"># CALL_SNIPPET</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Decrypt and execute marshaled code from &#39;unlucky&#39; list</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> s:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    key <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(): <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>__code__ <span style="color:#f92672">=</span> marshal<span style="color:#f92672">.</span>loads(bytes([b <span style="color:#f92672">^</span> key <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> unlucky<span style="color:#f92672">.</span>pop(<span style="color:#ae81ff">0</span>)]))
</span></span><span style="display:flex;"><span>    f()
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="swap--opcode-14">SWAP — Opcode 14</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">14</span>:  <span style="color:#75715e"># SWAP</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Swap values in the nm (DNA map)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(s) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Stack underflow&#39;</span>)
</span></span><span style="display:flex;"><span>    a, b <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>pop(), s<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> a <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> nm <span style="color:#f92672">or</span> b <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> nm:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;Invalid swap keys&#39;</span>)
</span></span><span style="display:flex;"><span>    nm[a], nm[b] <span style="color:#f92672">=</span> nm[b], nm[a]
</span></span><span style="display:flex;"><span>    pc <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h4 id="halt--opcode-15">HALT — Opcode 15</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#ae81ff">15</span>:  <span style="color:#75715e"># HALT</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Stop execution</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">break</span>
</span></span></code></pre></div><p>When running the VM with a test flag of the required 56-character length, the program crashes at the first <code>CALL_SNIPPET</code> instruction:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ python3 v1.py vm.dna
</span></span><span style="display:flex;"><span>&gt; .;.,;<span style="color:#f92672">{</span>the_secret_dna_koy_is_hiooon_horo_1234567890123aa<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Traceback <span style="color:#f92672">(</span>most recent call last<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;v1.py&#34;</span>, line 116, in &lt;module&gt;
</span></span><span style="display:flex;"><span>    f.__code__ <span style="color:#f92672">=</span> marshal.loads<span style="color:#f92672">(</span>bytes<span style="color:#f92672">([</span>b ^ key <span style="color:#66d9ef">for</span> b in unlucky.pop<span style="color:#f92672">(</span>0<span style="color:#f92672">)]))</span>
</span></span><span style="display:flex;"><span>ValueError: bad marshal data <span style="color:#f92672">(</span>unknown type code<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>After seeing this error, it suggests that the key is wrong. Let&rsquo;s examine where the key comes from. Looking at the assembly code before the crash:</p>
<pre tabindex="0"><code class="language-assembely" data-lang="assembely">015202: LOAD_MEM        Operand=666
015214: CALL_SNIPPET
</code></pre><p>The <code>LOAD_MEM</code> with operand 666 means <code>m[666]</code> is pushed to the stack, then when <code>CALL_SNIPPET</code> executes <code>key = s.pop()</code>, this becomes our decryption key. So the key is input-determined.</p>
<p>To find the valid key, we need to understand the memory layout:</p>
<ul>
<li>Flag bytes are stored starting at memory address 640</li>
<li>Flag format removes the first 6 characters (<code>.;,;.{</code>)</li>
<li>Therefore: <code>key = m[666] = flag[666 - 640 + 6] = flag[32]</code></li>
</ul>
<p>Since we need to find the valid key that should be at <code>m[666]</code>, we must brute force to find the correct character for <code>flag[32]</code>.</p>
<h3 id="brute-force-key-recovery">Brute Force Key Recovery</h3>
<p>Since the key must be a valid ASCII character (0-255), we can brute force all possible keys:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> key <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        decrypted <span style="color:#f92672">=</span> bytes([b <span style="color:#f92672">^</span> key <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> unlucky[<span style="color:#ae81ff">0</span>]])
</span></span><span style="display:flex;"><span>        obj <span style="color:#f92672">=</span> marshal<span style="color:#f92672">.</span>loads(decrypted)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Key </span><span style="color:#e6db74">{</span>key<span style="color:#e6db74">}</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">{</span>chr(key)<span style="color:#e6db74">}</span><span style="color:#e6db74">): Success - </span><span style="color:#e6db74">{</span>type(obj)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> isinstance(obj, types<span style="color:#f92672">.</span>CodeType):
</span></span><span style="display:flex;"><span>            dis<span style="color:#f92672">.</span>dis(obj)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span></code></pre></div><p><strong>Result</strong>: The correct key is <code>111</code> (ASCII &lsquo;o&rsquo;)</p>
<p>This means <code>flag[26]</code> should be &lsquo;o&rsquo; for the first bytecode to decrypt properly.</p>
<h2 id="systematic-approach">Systematic Approach</h2>
<p>Since <code>unlucky.pop(0)</code> consumes elements sequentially, we need to:</p>
<ol>
<li>Determine the correct key for <code>unlucky[0]</code> → <code>flag[26] = 'o'</code></li>
<li>Update the flag and continue execution to find the key for <code>unlucky[1]</code></li>
<li>Repeat for all four bytecode snippets</li>
</ol>
<h2 id="decompiled-python-code-from-unlucky-bytecode">Decompiled Python Code from <code>unlucky</code> Bytecode</h2>
<h3 id="unlucky0">unlucky[0]</h3>
<p><strong>Python Bytecode:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#ae81ff">15</span>           <span style="color:#ae81ff">0</span> BUILD_MAP                <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">2</span> STORE_FAST               <span style="color:#ae81ff">0</span> (tmp)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">16</span>           <span style="color:#ae81ff">4</span> LOAD_GLOBAL              <span style="color:#ae81ff">0</span> (nm)
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">6</span> LOAD_CONST               <span style="color:#ae81ff">1</span> (<span style="color:#e6db74">&#39;T&#39;</span>)
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">8</span> BINARY_SUBSCR
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">10</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (tmp)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">12</span> LOAD_CONST               <span style="color:#ae81ff">2</span> (<span style="color:#e6db74">&#39;A&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">14</span> STORE_SUBSCR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">17</span>          <span style="color:#ae81ff">16</span> LOAD_GLOBAL              <span style="color:#ae81ff">0</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">18</span> LOAD_CONST               <span style="color:#ae81ff">3</span> (<span style="color:#e6db74">&#39;G&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">20</span> BINARY_SUBSCR
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">22</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (tmp)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">24</span> LOAD_CONST               <span style="color:#ae81ff">1</span> (<span style="color:#e6db74">&#39;T&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">26</span> STORE_SUBSCR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">18</span>          <span style="color:#ae81ff">28</span> LOAD_GLOBAL              <span style="color:#ae81ff">0</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">30</span> LOAD_CONST               <span style="color:#ae81ff">4</span> (<span style="color:#e6db74">&#39;C&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">32</span> BINARY_SUBSCR
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">34</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (tmp)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">36</span> LOAD_CONST               <span style="color:#ae81ff">3</span> (<span style="color:#e6db74">&#39;G&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">38</span> STORE_SUBSCR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">19</span>          <span style="color:#ae81ff">40</span> LOAD_GLOBAL              <span style="color:#ae81ff">0</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">42</span> LOAD_CONST               <span style="color:#ae81ff">2</span> (<span style="color:#e6db74">&#39;A&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">44</span> BINARY_SUBSCR
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">46</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (tmp)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">48</span> LOAD_CONST               <span style="color:#ae81ff">4</span> (<span style="color:#e6db74">&#39;C&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">50</span> STORE_SUBSCR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">20</span>          <span style="color:#ae81ff">52</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (tmp)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">54</span> STORE_GLOBAL             <span style="color:#ae81ff">0</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">56</span> LOAD_CONST               <span style="color:#ae81ff">0</span> (<span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">58</span> RETURN_VALUE
</span></span></code></pre></div><p><strong>Decompiled Function:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">unlucky0</span>():
</span></span><span style="display:flex;"><span>    tmp <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>    tmp[<span style="color:#e6db74">&#39;A&#39;</span>] <span style="color:#f92672">=</span> nm[<span style="color:#e6db74">&#39;T&#39;</span>]  <span style="color:#75715e"># A gets T&#39;s value</span>
</span></span><span style="display:flex;"><span>    tmp[<span style="color:#e6db74">&#39;T&#39;</span>] <span style="color:#f92672">=</span> nm[<span style="color:#e6db74">&#39;G&#39;</span>]  <span style="color:#75715e"># T gets G&#39;s value  </span>
</span></span><span style="display:flex;"><span>    tmp[<span style="color:#e6db74">&#39;G&#39;</span>] <span style="color:#f92672">=</span> nm[<span style="color:#e6db74">&#39;C&#39;</span>]  <span style="color:#75715e"># G gets C&#39;s value</span>
</span></span><span style="display:flex;"><span>    tmp[<span style="color:#e6db74">&#39;C&#39;</span>] <span style="color:#f92672">=</span> nm[<span style="color:#e6db74">&#39;A&#39;</span>]  <span style="color:#75715e"># C gets A&#39;s value</span>
</span></span><span style="display:flex;"><span>    nm <span style="color:#f92672">=</span> tmp  <span style="color:#75715e"># Replace global nm mapping</span>
</span></span></code></pre></div><hr>
<h3 id="unlucky1">unlucky[1]</h3>
<p><strong>Python Bytecode:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#ae81ff">24</span>           <span style="color:#ae81ff">0</span> LOAD_CONST               <span style="color:#ae81ff">1</span> (<span style="color:#e6db74">&#39;AGCT&#39;</span>)
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">2</span> STORE_FAST               <span style="color:#ae81ff">0</span> (s1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">25</span>           <span style="color:#ae81ff">4</span> LOAD_CONST               <span style="color:#ae81ff">2</span> (<span style="color:#e6db74">&#39;TCAG&#39;</span>)
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">6</span> STORE_FAST               <span style="color:#ae81ff">1</span> (s2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">26</span>           <span style="color:#ae81ff">8</span> LOAD_CONST               <span style="color:#ae81ff">3</span> (<span style="color:#e6db74">&#39;CTGA&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">10</span> STORE_FAST               <span style="color:#ae81ff">2</span> (s3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">27</span>          <span style="color:#ae81ff">12</span> LOAD_CONST               <span style="color:#ae81ff">4</span> (<span style="color:#f92672">&lt;</span>code object unlucky at <span style="color:#ae81ff">0</span>x<span style="color:#f92672">...&gt;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">14</span> LOAD_CONST               <span style="color:#ae81ff">5</span> (<span style="color:#e6db74">&#39;unlucky_2.&lt;locals&gt;.&lt;dictcomp&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">16</span> MAKE_FUNCTION            <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">18</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (s1)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">20</span> GET_ITER
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">22</span> CALL_FUNCTION            <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">24</span> STORE_FAST               <span style="color:#ae81ff">3</span> (tmp)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">28</span>          <span style="color:#ae81ff">26</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (s1)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">28</span> LOAD_FAST                <span style="color:#ae81ff">1</span> (s2)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">30</span> LOAD_FAST                <span style="color:#ae81ff">2</span> (s3)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">32</span> BUILD_TUPLE              <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">34</span> GET_ITER
</span></span><span style="display:flex;"><span>                 <span style="color:#f92672">&gt;&gt;</span>   <span style="color:#ae81ff">36</span> FOR_ITER                <span style="color:#ae81ff">27</span> (to <span style="color:#ae81ff">92</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">38</span> STORE_FAST               <span style="color:#ae81ff">4</span> (s)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">29</span>          <span style="color:#ae81ff">40</span> LOAD_GLOBAL              <span style="color:#ae81ff">0</span> (enumerate)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">42</span> LOAD_GLOBAL              <span style="color:#ae81ff">1</span> (sorted)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">44</span> LOAD_GLOBAL              <span style="color:#ae81ff">2</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">46</span> LOAD_METHOD              <span style="color:#ae81ff">3</span> (keys)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">48</span> CALL_METHOD              <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">50</span> CALL_FUNCTION            <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">52</span> CALL_FUNCTION            <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">54</span> GET_ITER
</span></span><span style="display:flex;"><span>                 <span style="color:#f92672">&gt;&gt;</span>   <span style="color:#ae81ff">56</span> FOR_ITER                <span style="color:#ae81ff">16</span> (to <span style="color:#ae81ff">90</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">58</span> UNPACK_SEQUENCE          <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">60</span> STORE_FAST               <span style="color:#ae81ff">5</span> (i)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">62</span> STORE_FAST               <span style="color:#ae81ff">6</span> (c)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">30</span>          <span style="color:#ae81ff">64</span> LOAD_FAST                <span style="color:#ae81ff">3</span> (tmp)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">66</span> LOAD_FAST                <span style="color:#ae81ff">6</span> (c)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">68</span> DUP_TOP_TWO
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">70</span> BINARY_SUBSCR
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">72</span> LOAD_GLOBAL              <span style="color:#ae81ff">2</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">74</span> LOAD_FAST                <span style="color:#ae81ff">4</span> (s)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">76</span> LOAD_FAST                <span style="color:#ae81ff">5</span> (i)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">78</span> BINARY_SUBSCR
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">80</span> BINARY_SUBSCR
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">82</span> INPLACE_SUBTRACT
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">84</span> ROT_THREE
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">86</span> STORE_SUBSCR
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">88</span> JUMP_ABSOLUTE           <span style="color:#ae81ff">28</span> (to <span style="color:#ae81ff">56</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">29</span>     <span style="color:#f92672">&gt;&gt;</span>   <span style="color:#ae81ff">90</span> JUMP_ABSOLUTE           <span style="color:#ae81ff">18</span> (to <span style="color:#ae81ff">36</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">31</span>     <span style="color:#f92672">&gt;&gt;</span>   <span style="color:#ae81ff">92</span> LOAD_FAST                <span style="color:#ae81ff">3</span> (tmp)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">94</span> STORE_GLOBAL             <span style="color:#ae81ff">2</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">96</span> LOAD_CONST               <span style="color:#ae81ff">0</span> (<span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">98</span> RETURN_VALUE
</span></span></code></pre></div><p><strong>Decompiled Python Code:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">unlucky1</span>(nm_in):
</span></span><span style="display:flex;"><span>        s1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AGCT&#34;</span>
</span></span><span style="display:flex;"><span>        s2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;TCAG&#34;</span>
</span></span><span style="display:flex;"><span>        s3 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CTGA&#34;</span>
</span></span><span style="display:flex;"><span>        total <span style="color:#f92672">=</span> sum(nm_in<span style="color:#f92672">.</span>values())
</span></span><span style="display:flex;"><span>        tmp <span style="color:#f92672">=</span> {c: total <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> s1}
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> (s1, s2, s3):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> i, c <span style="color:#f92672">in</span> enumerate(sorted(nm_in<span style="color:#f92672">.</span>keys())):
</span></span><span style="display:flex;"><span>                        tmp[c] <span style="color:#f92672">-=</span> nm_in[s[i]]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> tmp
</span></span></code></pre></div><hr>
<h3 id="unlucky2">unlucky[2]</h3>
<p><strong>Python Bytecode:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#ae81ff">35</span>           <span style="color:#ae81ff">0</span> LOAD_GLOBAL              <span style="color:#ae81ff">0</span> (__import__)
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">2</span> LOAD_CONST               <span style="color:#ae81ff">1</span> (<span style="color:#e6db74">&#39;random&#39;</span>)
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">4</span> CALL_FUNCTION            <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">6</span> STORE_DEREF              <span style="color:#ae81ff">0</span> (r)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">36</span>           <span style="color:#ae81ff">8</span> LOAD_DEREF               <span style="color:#ae81ff">0</span> (r)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">10</span> LOAD_METHOD              <span style="color:#ae81ff">1</span> (seed)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>                            <span style="color:#ae81ff">12</span> LOAD_GLOBAL              <span style="color:#ae81ff">0</span> (__import__)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">14</span> LOAD_CONST               <span style="color:#ae81ff">2</span> (<span style="color:#e6db74">&#39;functools&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">16</span> CALL_FUNCTION            <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">18</span> LOAD_METHOD              <span style="color:#ae81ff">2</span> (reduce)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">20</span> LOAD_CONST               <span style="color:#ae81ff">3</span> (<span style="color:#f92672">&lt;</span>code object unlucky at <span style="color:#ae81ff">0</span>x<span style="color:#f92672">...&gt;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">22</span> LOAD_CONST               <span style="color:#ae81ff">4</span> (<span style="color:#e6db74">&#39;unlucky_3.&lt;locals&gt;.&lt;lambda&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">24</span> MAKE_FUNCTION            <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">26</span> LOAD_GLOBAL              <span style="color:#ae81ff">3</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">28</span> LOAD_METHOD              <span style="color:#ae81ff">4</span> (values)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">30</span> CALL_METHOD              <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">32</span> CALL_METHOD              <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">34</span> CALL_METHOD              <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">36</span> POP_TOP
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">37</span>          <span style="color:#ae81ff">38</span> LOAD_BUILD_CLASS
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">40</span> LOAD_CLOSURE             <span style="color:#ae81ff">0</span> (r)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">42</span> BUILD_TUPLE              <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">44</span> LOAD_CONST               <span style="color:#ae81ff">5</span> (<span style="color:#f92672">&lt;</span>code object unlucky at <span style="color:#ae81ff">0</span>x<span style="color:#f92672">...&gt;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">46</span> LOAD_CONST               <span style="color:#ae81ff">6</span> (<span style="color:#e6db74">&#39;unlucky&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">48</span> MAKE_FUNCTION            <span style="color:#ae81ff">8</span> (closure)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">50</span> LOAD_CONST               <span style="color:#ae81ff">6</span> (<span style="color:#e6db74">&#39;unlucky&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">52</span> LOAD_GLOBAL              <span style="color:#ae81ff">5</span> (dict)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">54</span> CALL_FUNCTION            <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">56</span> STORE_FAST               <span style="color:#ae81ff">0</span> (unlucky)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">53</span>          <span style="color:#ae81ff">58</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (unlucky)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">60</span> LOAD_GLOBAL              <span style="color:#ae81ff">3</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">62</span> CALL_FUNCTION            <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">64</span> STORE_GLOBAL             <span style="color:#ae81ff">3</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">66</span> LOAD_CONST               <span style="color:#ae81ff">0</span> (<span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">68</span> RETURN_VALUE
</span></span></code></pre></div><p><strong>Decompiled Python Code:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">unlucky2</span>(nm_in):
</span></span><span style="display:flex;"><span>        seed <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> nm_in<span style="color:#f92672">.</span>values():
</span></span><span style="display:flex;"><span>                seed <span style="color:#f92672">^=</span> v
</span></span><span style="display:flex;"><span>        random<span style="color:#f92672">.</span>seed(seed)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Unlucky</span>(dict):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, mapping):
</span></span><span style="display:flex;"><span>                        super()<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>(mapping)
</span></span><span style="display:flex;"><span>                        keys <span style="color:#f92672">=</span> list(<span style="color:#e6db74">&#34;ACGT&#34;</span>)
</span></span><span style="display:flex;"><span>                        random<span style="color:#f92672">.</span>shuffle(keys)
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>                                self[<span style="color:#e6db74">&#34;ACGT&#34;</span>[i]] <span style="color:#f92672">=</span> mapping[keys[i]]
</span></span><span style="display:flex;"><span>        new_nm <span style="color:#f92672">=</span> Unlucky(nm_in)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> new_nm
</span></span></code></pre></div><hr>
<h3 id="unlucky3">unlucky[3]</h3>
<p><strong>Python Bytecode:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#ae81ff">58</span>           <span style="color:#ae81ff">0</span> LOAD_BUILD_CLASS
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">2</span> LOAD_CONST               <span style="color:#ae81ff">1</span> (<span style="color:#f92672">&lt;</span>code object unlucky at <span style="color:#ae81ff">0</span>x<span style="color:#f92672">...&gt;</span>)
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">4</span> LOAD_CONST               <span style="color:#ae81ff">2</span> (<span style="color:#e6db74">&#39;MM&#39;</span>)
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">6</span> MAKE_FUNCTION            <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#ae81ff">8</span> LOAD_CONST               <span style="color:#ae81ff">2</span> (<span style="color:#e6db74">&#39;MM&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">10</span> LOAD_GLOBAL              <span style="color:#ae81ff">0</span> (type)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">12</span> CALL_FUNCTION            <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">14</span> STORE_FAST               <span style="color:#ae81ff">0</span> (MM)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">70</span>          <span style="color:#ae81ff">16</span> LOAD_BUILD_CLASS
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">18</span> LOAD_CONST               <span style="color:#ae81ff">3</span> (<span style="color:#f92672">&lt;</span>code object unlucky at <span style="color:#ae81ff">0</span>x<span style="color:#f92672">...&gt;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">20</span> LOAD_CONST               <span style="color:#ae81ff">4</span> (<span style="color:#e6db74">&#39;MD&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">22</span> MAKE_FUNCTION            <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">24</span> LOAD_CONST               <span style="color:#ae81ff">4</span> (<span style="color:#e6db74">&#39;MD&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">26</span> LOAD_GLOBAL              <span style="color:#ae81ff">1</span> (dict)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">28</span> LOAD_FAST                <span style="color:#ae81ff">0</span> (MM)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">30</span> LOAD_CONST               <span style="color:#ae81ff">5</span> ((<span style="color:#e6db74">&#39;metaclass&#39;</span>,))
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">32</span> CALL_FUNCTION_KW         <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">34</span> STORE_FAST               <span style="color:#ae81ff">1</span> (MD)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">73</span>          <span style="color:#ae81ff">36</span> LOAD_GLOBAL              <span style="color:#ae81ff">2</span> (exec)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">38</span> LOAD_CONST               <span style="color:#ae81ff">6</span> (<span style="color:#e6db74">&#34;globals()[&#39;nucleotide_map&#39;] = MD(&#34;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">40</span> LOAD_GLOBAL              <span style="color:#ae81ff">1</span> (dict)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">42</span> LOAD_GLOBAL              <span style="color:#ae81ff">3</span> (nm)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">44</span> CALL_FUNCTION            <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">46</span> FORMAT_VALUE             <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">48</span> LOAD_CONST               <span style="color:#ae81ff">7</span> (<span style="color:#e6db74">&#39;)&#39;</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">50</span> BUILD_STRING             <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">52</span> CALL_FUNCTION            <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">54</span> POP_TOP
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">56</span> LOAD_CONST               <span style="color:#ae81ff">0</span> (<span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>                            <span style="color:#ae81ff">58</span> RETURN_VALUE
</span></span></code></pre></div><p><strong>Decompiled Python Code:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">unlucky3</span>(nm_in):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MM</span>(type):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__new__</span>(cls, name, bases, dct):
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">return</span> super()<span style="color:#f92672">.</span><span style="color:#a6e22e">__new__</span>(cls, name, bases, dct)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__call__</span>(cls, <span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>                        instance <span style="color:#f92672">=</span> super()<span style="color:#f92672">.</span><span style="color:#a6e22e">__call__</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>                        vals <span style="color:#f92672">=</span> list(instance<span style="color:#f92672">.</span>values())
</span></span><span style="display:flex;"><span>                        vals <span style="color:#f92672">=</span> vals[::<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> vals[<span style="color:#ae81ff">1</span>::<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">for</span> i, k <span style="color:#f92672">in</span> enumerate(sorted(instance<span style="color:#f92672">.</span>keys())):
</span></span><span style="display:flex;"><span>                                instance[k] <span style="color:#f92672">=</span> vals[i]
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">return</span> instance
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MD</span>(dict, metaclass<span style="color:#f92672">=</span>MM):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        new_nm <span style="color:#f92672">=</span> MD(dict(nm_in))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> new_nm
</span></span></code></pre></div><p><a href="./nmExctrator.py">nmExctractor</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Initial nm:&#34;</span>, nm)
</span></span><span style="display:flex;"><span>nm <span style="color:#f92672">=</span> unlucky0(nm)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;After unlucky0, nm =&#34;</span>, nm)
</span></span><span style="display:flex;"><span>nm <span style="color:#f92672">=</span> unlucky1(nm)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;After unlucky1, nm =&#34;</span>, nm)
</span></span><span style="display:flex;"><span>nm <span style="color:#f92672">=</span> unlucky2(nm)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;After unlucky2, nm =&#34;</span>, nm)
</span></span><span style="display:flex;"><span>nm <span style="color:#f92672">=</span> unlucky3(nm)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;After unlucky3, nm =&#34;</span>, nm)
</span></span></code></pre></div><h2 id="output">Output</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Initial nm: {&#39;A&#39;: 0, &#39;T&#39;: 1, &#39;G&#39;: 2, &#39;C&#39;: 3}
</span></span><span style="display:flex;"><span>After unlucky0, nm = {&#39;A&#39;: 1, &#39;T&#39;: 2, &#39;G&#39;: 3, &#39;C&#39;: 0}
</span></span><span style="display:flex;"><span>After unlucky1, nm = {&#39;A&#39;: 3, &#39;G&#39;: 2, &#39;C&#39;: 1, &#39;T&#39;: 0}
</span></span><span style="display:flex;"><span>After unlucky2, nm = {&#39;A&#39;: 2, &#39;G&#39;: 1, &#39;C&#39;: 3, &#39;T&#39;: 0}
</span></span><span style="display:flex;"><span>After unlucky3, nm = {&#39;A&#39;: 2, &#39;G&#39;: 1, &#39;C&#39;: 3, &#39;T&#39;: 0}
</span></span></code></pre></div><h2 id="explanation">Explanation</h2>
<ul>
<li><strong>Initial nm</strong>: The starting nucleotide map is <code>{'A': 0, 'T': 1, 'G': 2, 'C': 3}</code>.</li>
<li><strong>After unlucky0</strong>: The nucleotide map is updated based on the first transformation function.</li>
<li><strong>After unlucky1</strong>: The nucleotide map is further transformed using the second function.</li>
<li><strong>After unlucky2</strong>: The third transformation function applies additional changes.</li>
<li><strong>After unlucky3</strong>: The final transformation function is applied, resulting in the final nucleotide map.</li>
</ul>
<p>Each function (<code>unlucky0</code>, <code>unlucky1</code>, <code>unlucky2</code>, <code>unlucky3</code>) modifies the global <code>nm</code> variable, and the changes are printed after each step.</p>
<p>Before starting to write the assembler, I manually verified the state of the <code>nm</code> mapping after each <code>CALL</code> instruction (opcode 13). This was done by checking the operand of the <code>LOAD</code> instruction preceding each <code>CALL</code>. Below are the results of the dynamic disassembly:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜  sol awk <span style="color:#e6db74">&#39;/CALL/ {  print lines[NR-1]; print } { lines[NR] = $0 }&#39;</span> asm.txt 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===</span> DYNAMIC DISASSEMBLY <span style="color:#f92672">===</span>
</span></span><span style="display:flex;"><span>DEBUG: After CALL <span style="color:#75715e">#1, nm updated to: {&#39;A&#39;: 1, &#39;T&#39;: 2, &#39;G&#39;: 3, &#39;C&#39;: 0}</span>
</span></span><span style="display:flex;"><span>DEBUG: After CALL <span style="color:#75715e">#1, nm updated to: {&#39;A&#39;: 1, &#39;T&#39;: 2, &#39;G&#39;: 3, &#39;C&#39;: 0}</span>
</span></span><span style="display:flex;"><span>DEBUG: After CALL <span style="color:#75715e">#2, nm updated to: {&#39;A&#39;: 3, &#39;G&#39;: 2, &#39;C&#39;: 1, &#39;T&#39;: 0}</span>
</span></span><span style="display:flex;"><span>DEBUG: After CALL <span style="color:#75715e">#2, nm updated to: {&#39;A&#39;: 3, &#39;G&#39;: 2, &#39;C&#39;: 1, &#39;T&#39;: 0}</span>
</span></span><span style="display:flex;"><span>DEBUG: After CALL <span style="color:#75715e">#3, nm updated to: {&#39;A&#39;: 2, &#39;G&#39;: 1, &#39;C&#39;: 3, &#39;T&#39;: 0}</span>
</span></span><span style="display:flex;"><span>DEBUG: After CALL <span style="color:#75715e">#3, nm updated to: {&#39;A&#39;: 2, &#39;G&#39;: 1, &#39;C&#39;: 3, &#39;T&#39;: 0}</span>
</span></span><span style="display:flex;"><span>DEBUG: After CALL <span style="color:#75715e">#4, nm updated to: {&#39;A&#39;: 2, &#39;G&#39;: 1, &#39;C&#39;: 3, &#39;T&#39;: 0}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">==================================================</span>
</span></span><span style="display:flex;"><span>Nucleotide mappings change after each CALL instruction
</span></span><span style="display:flex;"><span>15202: LOAD     GGTGGAAAAA <span style="color:#f92672">(</span>666<span style="color:#f92672">)</span> ; debug marker <span style="color:#f92672">[</span>nm: A<span style="color:#f92672">=</span>0,T<span style="color:#f92672">=</span>1,G<span style="color:#f92672">=</span>2,C<span style="color:#f92672">=</span>3<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>15214: CALL     ; will change nucleotide mapping <span style="color:#f92672">[</span>nm: A<span style="color:#f92672">=</span>0,T<span style="color:#f92672">=</span>1,G<span style="color:#f92672">=</span>2,C<span style="color:#f92672">=</span>3<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>30418: LOAD     GTATTCCCCC <span style="color:#f92672">(</span>667<span style="color:#f92672">)</span> ; flag<span style="color:#f92672">[</span>27<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>nm: A<span style="color:#f92672">=</span>1,T<span style="color:#f92672">=</span>2,G<span style="color:#f92672">=</span>3,C<span style="color:#f92672">=</span>0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>30430: CALL     ; will change nucleotide mapping <span style="color:#f92672">[</span>nm: A<span style="color:#f92672">=</span>1,T<span style="color:#f92672">=</span>2,G<span style="color:#f92672">=</span>3,C<span style="color:#f92672">=</span>0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>45634: LOAD     GCCGGTTTTT <span style="color:#f92672">(</span>662<span style="color:#f92672">)</span> ; flag<span style="color:#f92672">[</span>22<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>nm: A<span style="color:#f92672">=</span>3,T<span style="color:#f92672">=</span>0,G<span style="color:#f92672">=</span>2,C<span style="color:#f92672">=</span>1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>45646: CALL     ; will change nucleotide mapping <span style="color:#f92672">[</span>nm: A<span style="color:#f92672">=</span>3,T<span style="color:#f92672">=</span>0,G<span style="color:#f92672">=</span>2,C<span style="color:#f92672">=</span>1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>60850: LOAD     GTAAATTTTT <span style="color:#f92672">(</span>673<span style="color:#f92672">)</span> ; flag<span style="color:#f92672">[</span>33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>nm: A<span style="color:#f92672">=</span>2,T<span style="color:#f92672">=</span>0,G<span style="color:#f92672">=</span>1,C<span style="color:#f92672">=</span>3<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>60862: CALL     ; will change nucleotide mapping <span style="color:#f92672">[</span>nm: A<span style="color:#f92672">=</span>2,T<span style="color:#f92672">=</span>0,G<span style="color:#f92672">=</span>1,C<span style="color:#f92672">=</span>3<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Total instructions: <span style="color:#ae81ff">9844</span>
</span></span><span style="display:flex;"><span>CALL operations: <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>➜  sol 
</span></span></code></pre></div><p>Based on the disassembly:</p>
<ul>
<li><code>m[640 + 26] = 111</code> (ASCII for &lsquo;o&rsquo;)</li>
<li><code>m[640 + 27] = 117</code> (ASCII for &lsquo;u&rsquo;)</li>
<li><code>m[640 + 22] = 105</code> (ASCII for &lsquo;i&rsquo;)</li>
<li><code>m[640 + 33] = 97</code> (ASCII for &lsquo;a&rsquo;)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>flag[<span style="color:#ae81ff">26</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">111</span> 
</span></span><span style="display:flex;"><span>flag[<span style="color:#ae81ff">27</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">117</span>
</span></span><span style="display:flex;"><span>flag[<span style="color:#ae81ff">22</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">105</span>
</span></span><span style="display:flex;"><span>flag[<span style="color:#ae81ff">33</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">97</span>
</span></span></code></pre></div><h3 id="next-steps">Next Steps</h3>
<p>Using the above observations, I will proceed to write the assembler, ensuring that the dynamic changes to the <code>nm</code> mapping are accounted for at each step.</p>
<p>python disassembler</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List, Tuple, Dict
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DynamicDNADisassembler</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>initial_nm <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">3</span>}
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>instructions <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">0</span>: <span style="color:#e6db74">&#34;PUSH&#34;</span>,      
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">1</span>: <span style="color:#e6db74">&#34;POP&#34;</span>,       
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">2</span>: <span style="color:#e6db74">&#34;LOAD&#34;</span>,      
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">3</span>: <span style="color:#e6db74">&#34;STORE&#34;</span>,     
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">4</span>: <span style="color:#e6db74">&#34;ADD&#34;</span>,       
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">5</span>: <span style="color:#e6db74">&#34;SUB&#34;</span>,       
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">6</span>: <span style="color:#e6db74">&#34;MUL&#34;</span>,       
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">7</span>: <span style="color:#e6db74">&#34;MOD&#34;</span>,       
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">8</span>: <span style="color:#e6db74">&#34;EQ&#34;</span>,        
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">9</span>: <span style="color:#e6db74">&#34;JMP&#34;</span>,       
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">10</span>: <span style="color:#e6db74">&#34;JEQ&#34;</span>,      
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">11</span>: <span style="color:#e6db74">&#34;JNE&#34;</span>,      
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">12</span>: <span style="color:#e6db74">&#34;PRINT&#34;</span>,    
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">13</span>: <span style="color:#e6db74">&#34;CALL&#34;</span>,     
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">14</span>: <span style="color:#e6db74">&#34;SWAP&#34;</span>,     
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">15</span>: <span style="color:#e6db74">&#34;HALT&#34;</span>      
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>mapping_transforms <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">111</span>: {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">0</span>},
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">117</span>: {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#ae81ff">0</span>},
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">105</span>: {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#ae81ff">0</span>}
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>predefined_values <span style="color:#f92672">=</span> {<span style="color:#ae81ff">22</span>: <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">26</span>: <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">27</span>: <span style="color:#ae81ff">117</span>}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">trans</span>(self, dna_sequence: str, nm: Dict[str, int]) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sum((nm[c] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> i <span style="color:#66d9ef">for</span> i, c <span style="color:#f92672">in</span> enumerate(dna_sequence)))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reverse_trans</span>(self, value: int, length: int) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>        nucleotides <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;T&#39;</span>, <span style="color:#e6db74">&#39;G&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span>]
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length):
</span></span><span style="display:flex;"><span>            result<span style="color:#f92672">.</span>append(nucleotides[(value <span style="color:#f92672">&gt;&gt;</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> i)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(result)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">predict_call_key</span>(self, instructions_so_far: List, current_stack: List[int]) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> addr, instr, operand_dna, operand <span style="color:#f92672">in</span> reversed(instructions_so_far[<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>:]):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> instr <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;LOAD&#34;</span> <span style="color:#f92672">and</span> operand <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>predefined_values:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>predefined_values[operand]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">disassemble_dynamic</span>(self, code: str) <span style="color:#f92672">-&gt;</span> List[Tuple[int, str, str, int, Dict[str, int]]]:
</span></span><span style="display:flex;"><span>        instructions <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        pc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        current_nm <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>initial_nm<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>        call_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> pc <span style="color:#f92672">&lt;</span> len(code):
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&gt;</span> len(code):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>            opcode_dna <span style="color:#f92672">=</span> code[pc:pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>            opcode <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>trans(opcode_dna, current_nm)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> opcode <span style="color:#f92672">in</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>]:
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                operand_dna <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                operand <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                instruction_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span> <span style="color:#f92672">&gt;</span> len(code):
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>                operand_dna <span style="color:#f92672">=</span> code[pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>:pc <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>                operand <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>trans(operand_dna, current_nm)
</span></span><span style="display:flex;"><span>                instruction_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            instr_name <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>instructions<span style="color:#f92672">.</span>get(opcode, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;UNKNOWN_</span><span style="color:#e6db74">{</span>opcode<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append((pc, instr_name, operand_dna, operand, current_nm<span style="color:#f92672">.</span>copy()))
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> instr_name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;CALL&#34;</span>:
</span></span><span style="display:flex;"><span>                call_count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                predicted_key <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> call_count <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                    predicted_key <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> call_count <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>                    predicted_key <span style="color:#f92672">=</span> <span style="color:#ae81ff">117</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> call_count <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">3</span>:
</span></span><span style="display:flex;"><span>                    predicted_key <span style="color:#f92672">=</span> <span style="color:#ae81ff">105</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> predicted_key <span style="color:#f92672">and</span> predicted_key <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>mapping_transforms:
</span></span><span style="display:flex;"><span>                    current_nm <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>mapping_transforms[predicted_key]<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>                    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;DEBUG: After CALL #</span><span style="color:#e6db74">{</span>call_count<span style="color:#e6db74">}</span><span style="color:#e6db74">, nm updated to: </span><span style="color:#e6db74">{</span>current_nm<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            pc <span style="color:#f92672">+=</span> instruction_length
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> instructions
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">format_instruction_dynamic</span>(self, addr: int, instr: str, operand_dna: str, 
</span></span><span style="display:flex;"><span>                                 operand: int, nm: Dict[str, int], call_count: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>        addr_str <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>addr<span style="color:#e6db74">:</span><span style="color:#e6db74">04d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        nm_str <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[nm: A=</span><span style="color:#e6db74">{</span>nm[<span style="color:#e6db74">&#39;A&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">,T=</span><span style="color:#e6db74">{</span>nm[<span style="color:#e6db74">&#39;T&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">,G=</span><span style="color:#e6db74">{</span>nm[<span style="color:#e6db74">&#39;G&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">,C=</span><span style="color:#e6db74">{</span>nm[<span style="color:#e6db74">&#39;C&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> operand_dna:
</span></span><span style="display:flex;"><span>            base_str <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>addr_str<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>instr<span style="color:#e6db74">:</span><span style="color:#e6db74">&lt;8</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>operand_dna<span style="color:#e6db74">}</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">{</span>operand<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> instr <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#34;LOAD&#34;</span>, <span style="color:#e6db74">&#34;STORE&#34;</span>]:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> operand <span style="color:#f92672">==</span> <span style="color:#ae81ff">666</span>:
</span></span><span style="display:flex;"><span>                    base_str <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34; ; debug marker&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> operand <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">640</span> <span style="color:#f92672">and</span> operand <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">696</span>:
</span></span><span style="display:flex;"><span>                    base_str <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34; ; flag[</span><span style="color:#e6db74">{</span>operand<span style="color:#f92672">-</span><span style="color:#ae81ff">640</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> operand <span style="color:#f92672">in</span> [<span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>]:
</span></span><span style="display:flex;"><span>                    value <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>predefined_values<span style="color:#f92672">.</span>get(operand, <span style="color:#e6db74">&#34;unknown&#34;</span>)
</span></span><span style="display:flex;"><span>                    base_str <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34; ; predefined value=</span><span style="color:#e6db74">{</span>value<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>base_str<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>nm_str<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> instr <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;CALL&#34;</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>addr_str<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>instr<span style="color:#e6db74">:</span><span style="color:#e6db74">&lt;8</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> ; will change nucleotide mapping </span><span style="color:#e6db74">{</span>nm_str<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>addr_str<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>instr<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{</span>nm_str<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">disassemble_file_dynamic</span>(self, filename: str) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">with</span> open(filename, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>                code <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">FileNotFoundError</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error: File &#39;</span><span style="color:#e6db74">{</span>filename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; not found&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error reading file: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        instructions <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>disassemble_dynamic(code)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> instructions:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;No valid instructions found&#34;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        output_lines <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        output_lines<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;Dynamic DNA Virtual Machine Disassembly&#34;</span>)
</span></span><span style="display:flex;"><span>        output_lines<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;=&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">50</span>)
</span></span><span style="display:flex;"><span>        output_lines<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;Nucleotide mappings change after each CALL instruction&#34;</span>)
</span></span><span style="display:flex;"><span>        output_lines<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        call_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> addr, instr, operand_dna, operand, nm <span style="color:#f92672">in</span> instructions:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> instr <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;CALL&#34;</span>:
</span></span><span style="display:flex;"><span>                call_count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            output_lines<span style="color:#f92672">.</span>append(self<span style="color:#f92672">.</span>format_instruction_dynamic(addr, instr, operand_dna, operand, nm, call_count))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        output_lines<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>        output_lines<span style="color:#f92672">.</span>append(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Total instructions: </span><span style="color:#e6db74">{</span>len(instructions)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        output_lines<span style="color:#f92672">.</span>append(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;CALL operations: </span><span style="color:#e6db74">{</span>call_count<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>join(output_lines)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">analyze_mapping_evolution</span>(self, code: str) <span style="color:#f92672">-&gt;</span> Dict:
</span></span><span style="display:flex;"><span>        instructions <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>disassemble_dynamic(code)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        mapping_states <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        call_positions <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> addr, instr, operand_dna, operand, nm <span style="color:#f92672">in</span> instructions:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> instr <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;CALL&#34;</span>:
</span></span><span style="display:flex;"><span>                call_positions<span style="color:#f92672">.</span>append(addr)
</span></span><span style="display:flex;"><span>            mapping_states<span style="color:#f92672">.</span>append((addr, nm<span style="color:#f92672">.</span>copy()))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;mapping_evolution&#39;</span>: mapping_states,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;call_positions&#39;</span>: call_positions,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;total_calls&#39;</span>: len(call_positions)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Usage: </span><span style="color:#e6db74">{</span>sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74"> &lt;dna_bytecode_file&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    disassembler <span style="color:#f92672">=</span> DynamicDNADisassembler()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;=== DYNAMIC DISASSEMBLY ===&#34;</span>)
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> disassembler<span style="color:#f92672">.</span>disassemble_file_dynamic(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    print(result)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><p>the results instructions was good especially that we had exactly
4 call instructions</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Total instructions: <span style="color:#ae81ff">9844</span>
</span></span><span style="display:flex;"><span>CALL operations: <span style="color:#ae81ff">4</span>
</span></span></code></pre></div><p>To reverse the VM instructions, we begin by analyzing the repeated structure of the first few lines. Here&rsquo;s a representative snippet:</p>
<pre tabindex="0"><code class="language-assembely" data-lang="assembely">0000: LOAD     AAAGGAAAAA (640) ; flag[0] [nm: A=0,T=1,G=2,C=3]
0012: PUSH     GGGTAAAAAA (106) [nm: A=0,T=1,G=2,C=3]
0024: MUL [nm: A=0,T=1,G=2,C=3]
0026: LOAD     TAAGGAAAAA (641) ; flag[1] [nm: A=0,T=1,G=2,C=3]
0038: PUSH     CGTAAAAAAA (27) [nm: A=0,T=1,G=2,C=3]
0050: MUL [nm: A=0,T=1,G=2,C=3]
0052: LOAD     GAAGGAAAAA (642) ; flag[2] [nm: A=0,T=1,G=2,C=3]
0064: PUSH     ACAGAAAAAA (140) [nm: A=0,T=1,G=2,C=3]
0076: MUL [nm: A=0,T=1,G=2,C=3]
0078: LOAD     CAAGGAAAAA (643) ; flag[3] [nm: A=0,T=1,G=2,C=3]
0090: PUSH     GGAGAAAAAA (138) [nm: A=0,T=1,G=2,C=3]
0102: MUL [nm: A=0,T=1,G=2,C=3]
0104: LOAD     ATAGGAAAAA (644) ; flag[4] [nm: A=0,T=1,G=2,C=3]
0116: PUSH     ACGTAAAAAA (108) [nm: A=0,T=1,G=2,C=3]
0128: MUL [nm: A=0,T=1,G=2,C=3]
0130: LOAD     TTAGGAAAAA (645) ; flag[5] [nm: A=0,T=1,G=2,C=3]
0142: PUSH     CGTTAAAAAA (91) [nm: A=0,T=1,G=2,C=3]
0154: MUL [nm: A=0,T=1,G=2,C=3]
0156: LOAD     GTAGGAAAAA (646) ; flag[6] [nm: A=0,T=1,G=2,C=3]
0168: PUSH     CAAGAAAAAA (131) [nm: A=0,T=1,G=2,C=3]
0180: MUL [nm: A=0,T=1,G=2,C=3]
0182: LOAD     CTAGGAAAAA (647) ; flag[7] [nm: A=0,T=1,G=2,C=3]
0194: PUSH     GGAGAAAAAA (138) [nm: A=0,T=1,G=2,C=3]
0206: MUL [nm: A=0,T=1,G=2,C=3]
0208: LOAD     AGAGGAAAAA (648) ; flag[8] [nm: A=0,T=1,G=2,C=3]
0220: PUSH     GGGTAAAAAA (106) [nm: A=0,T=1,G=2,C=3]
0232: MUL [nm: A=0,T=1,G=2,C=3]
0234: LOAD     TGAGGAAAAA (649) ; flag[9] [nm: A=0,T=1,G=2,C=3]
0246: PUSH     CCCTAAAAAA (127) [nm: A=0,T=1,G=2,C=3]
0258: MUL [nm: A=0,T=1,G=2,C=3]
0260: LOAD     GGAGGAAAAA (650) ; flag[10] [nm: A=0,T=1,G=2,C=3]
0272: PUSH     TAGGAAAAAA (161) [nm: A=0,T=1,G=2,C=3]
0284: MUL [nm: A=0,T=1,G=2,C=3]
0286: LOAD     CGAGGAAAAA (651) ; flag[11] [nm: A=0,T=1,G=2,C=3]
0298: PUSH     CACTAAAAAA (115) [nm: A=0,T=1,G=2,C=3]
0310: MUL [nm: A=0,T=1,G=2,C=3]
...
</code></pre><p>Instruction Semantics:</p>
<pre><code>LOAD (addr) – pushes the value at memory[addr] (i.e., flag[i]) onto the stack.

PUSH (val) – pushes a constant coefficient onto the stack.

MUL – pops two values, multiplies them, and pushes the result.

This forms flag[i] × Cj[i].
</code></pre>
<p>This pattern of LOAD, PUSH, MUL repeats 49 times, suggesting a coefficient vector Cj of length 49.</p>
<p>Following that, we see a sequence of ADD instructions:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">1274: ADD [nm: A=0,T=1,G=2,C=3]
1276: ADD [nm: A=0,T=1,G=2,C=3]
1278: ADD [nm: A=0,T=1,G=2,C=3]
1280: ADD [nm: A=0,T=1,G=2,C=3]
1282: ADD [nm: A=0,T=1,G=2,C=3]
1284: ADD [nm: A=0,T=1,G=2,C=3]
1286: ADD [nm: A=0,T=1,G=2,C=3]
1288: ADD [nm: A=0,T=1,G=2,C=3]
1290: ADD [nm: A=0,T=1,G=2,C=3]
1292: ADD [nm: A=0,T=1,G=2,C=3]
1294: ADD [nm: A=0,T=1,G=2,C=3]
1296: ADD [nm: A=0,T=1,G=2,C=3]
1298: ADD [nm: A=0,T=1,G=2,C=3]
1300: ADD [nm: A=0,T=1,G=2,C=3]
1302: ADD [nm: A=0,T=1,G=2,C=3]
1304: ADD [nm: A=0,T=1,G=2,C=3]
1306: ADD [nm: A=0,T=1,G=2,C=3]
1308: ADD [nm: A=0,T=1,G=2,C=3]
1310: ADD [nm: A=0,T=1,G=2,C=3]
1312: ADD [nm: A=0,T=1,G=2,C=3]
1314: ADD [nm: A=0,T=1,G=2,C=3]
1316: ADD [nm: A=0,T=1,G=2,C=3]
1318: ADD [nm: A=0,T=1,G=2,C=3]
1320: ADD [nm: A=0,T=1,G=2,C=3]
1322: ADD [nm: A=0,T=1,G=2,C=3]
1324: ADD [nm: A=0,T=1,G=2,C=3]
...
</code></pre><p>There are 48 ADD instructions, which cumulatively reduce the 49 products to a single sum.</p>
<p>Thus, each block of operations computes:</p>
<p>$$
\sum_{i=0}^{48} \text{flag}[i] \times C_j[i]
$$</p>
<p>This entire process is repeated 49 times, meaning the index j ranges from 0 to 48. For each repetition, a new coefficient vector Cj is used, so we must extract all 49 coefficient vectors C₀, C₁, &hellip;, C₄₈.</p>
<p>i wrote this parser to exctract them all</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_assembly_equations</span>(assembly_lines):
</span></span><span style="display:flex;"><span>    equations <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    current_constants <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    in_sequence <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    load_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    prev_instruction <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> assembly_lines:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">match</span> <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^\d+:\s*(\w+)\s*(?:([A-Z]+\s*\(\d+\))|\(\d+\))?&#39;</span>, line<span style="color:#f92672">.</span>strip())
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">match</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        instruction <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span><span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> instruction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;LOAD&#39;</span> <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> in_sequence:
</span></span><span style="display:flex;"><span>            in_sequence <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>            load_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            current_constants <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> in_sequence <span style="color:#f92672">and</span> instruction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;PUSH&#39;</span>:
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span><span style="color:#f92672">.</span>group(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> value:
</span></span><span style="display:flex;"><span>                constant <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\((\d+)\)&#39;</span>, value)<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>                current_constants<span style="color:#f92672">.</span>append(constant)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> in_sequence <span style="color:#f92672">and</span> instruction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;LOAD&#39;</span>:
</span></span><span style="display:flex;"><span>            load_count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> in_sequence <span style="color:#f92672">and</span> instruction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;ADD&#39;</span>:
</span></span><span style="display:flex;"><span>            prev_instruction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ADD&#39;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> in_sequence <span style="color:#f92672">and</span> instruction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;STORE&#39;</span> <span style="color:#f92672">and</span> prev_instruction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;ADD&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> load_count <span style="color:#f92672">==</span> len(current_constants) <span style="color:#f92672">and</span> load_count <span style="color:#f92672">==</span> <span style="color:#ae81ff">49</span>:
</span></span><span style="display:flex;"><span>                equation <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;sum_</span><span style="color:#ae81ff">{{</span><span style="color:#e6db74">i=0</span><span style="color:#ae81ff">}}</span><span style="color:#e6db74">^</span><span style="color:#ae81ff">{{</span><span style="color:#e6db74">48</span><span style="color:#ae81ff">}}</span><span style="color:#e6db74"> flag[i] × J[i], where J[i] = [</span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;, &#39;</span><span style="color:#f92672">.</span>join(current_constants)<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>
</span></span><span style="display:flex;"><span>                eq_number_match <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\((\d+)\)&#39;</span>, line)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> eq_number_match:
</span></span><span style="display:flex;"><span>                    eq_number <span style="color:#f92672">=</span> int(eq_number_match<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>                    equations<span style="color:#f92672">.</span>append((eq_number, equation))
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Warning: Could not find equation number in line: </span><span style="color:#e6db74">{</span>line<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            in_sequence <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            prev_instruction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;STORE&#39;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> in_sequence <span style="color:#f92672">and</span> instruction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;LOAD&#39;</span> <span style="color:#f92672">and</span> prev_instruction <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;STORE&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> load_count <span style="color:#f92672">==</span> len(current_constants) <span style="color:#f92672">and</span> load_count <span style="color:#f92672">==</span> <span style="color:#ae81ff">49</span>:
</span></span><span style="display:flex;"><span>                equation <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;sum_</span><span style="color:#ae81ff">{{</span><span style="color:#e6db74">i=0</span><span style="color:#ae81ff">}}</span><span style="color:#e6db74">^</span><span style="color:#ae81ff">{{</span><span style="color:#e6db74">48</span><span style="color:#ae81ff">}}</span><span style="color:#e6db74"> flag[i] × J[i], where J[i] = [</span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;, &#39;</span><span style="color:#f92672">.</span>join(current_constants)<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>
</span></span><span style="display:flex;"><span>                equations<span style="color:#f92672">.</span>append((<span style="color:#66d9ef">None</span>, equation))
</span></span><span style="display:flex;"><span>            in_sequence <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            load_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            current_constants <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            prev_instruction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;LOAD&#39;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            prev_instruction <span style="color:#f92672">=</span> instruction
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> equations
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;asm.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    lines <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>readlines()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>equations <span style="color:#f92672">=</span> parse_assembly_equations(lines)
</span></span><span style="display:flex;"><span>print(len(equations), <span style="color:#e6db74">&#34;equations found:&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> eq_number, eq <span style="color:#f92672">in</span> equations:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Equation stored at </span><span style="color:#e6db74">{</span>eq_number<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{</span>eq<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="coefficient-vectors-cj">Coefficient Vectors (Cj)</h3>
<p>The coefficient vectors (Cj) of length 49 for each j ranging from 0 to 48 were extracted. These coefficients are stored in memory starting at address <code>4096</code>, with each vector occupying 4 consecutive memory slots. Below is the result:</p>
<h4 id="memory-layout-for-coefficient-vectors">Memory Layout for Coefficient Vectors</h4>
<ul>
<li><code>memory[4096]</code> to <code>memory[4096 + 4 * 48]</code> contain the coefficients for all 49 equations.</li>
</ul>
<h4 id="example-coefficients">Example Coefficients</h4>
<p>Here are some of the extracted coefficient vectors:</p>
<ul>
<li>
<p><strong>C₀ (memory[4096]):</strong></p>
<pre tabindex="0"><code>[106, 27, 140, 138, 108, 91, 131, 138, 106, 127, 161, 115, 177, 152, 15, 55, 230, 131, 147, 183, 235, 197, 200, 104, 188, 196, 118, 28, 21, 97, 151, 217, 118, 22, 212, 31, 101, 227, 155, 237, 146, 68, 75, 71, 218, 173, 41, 220, 161]
</code></pre></li>
<li>
<p><strong>C₁ (memory[4100]):</strong></p>
<pre tabindex="0"><code>[56, 249, 152, 225, 66, 136, 113, 243, 63, 233, 254, 69, 191, 1, 147, 169, 118, 97, 193, 175, 25, 141, 234, 105, 9, 53, 115, 162, 104, 104, 153, 57, 11, 28, 3, 146, 14, 70, 154, 102, 169, 66, 133, 29, 107, 155, 22, 231, 61]
</code></pre></li>
<li>
<p><strong>C₂ (memory[4104]):</strong></p>
<pre tabindex="0"><code>[149, 104, 66, 72, 140, 134, 140, 174, 236, 10, 209, 162, 15, 223, 191, 183, 77, 137, 106, 69, 54, 1, 122, 195, 62, 99, 155, 10, 18, 117, 164, 216, 231, 150, 255, 127, 193, 145, 190, 34, 46, 64, 189, 182, 27, 163, 156, 156, 150]
</code></pre></li>
</ul>
<p>&hellip;</p>
<ul>
<li>
<p><strong>C₄₈ (memory[4288]):</strong></p>
<pre tabindex="0"><code>[10, 177, 31, 35, 108, 132, 53, 119, 122, 72, 51, 62, 160, 167, 251, 191, 245, 142, 79, 235, 184, 142, 194, 218, 240, 66, 226, 179, 125, 18, 246, 234, 25, 56, 4, 240, 215, 214, 42, 143, 32, 87, 5, 215, 62, 231, 179, 186, 219]
</code></pre></li>
<li>
<p>Each coefficient vector is used in one of the 49 equations.</p>
</li>
<li>
<p>The equations are structured as:</p>
</li>
</ul>
<p>$$
\sum_{i=0}^{48} \text{flag}[i] \times C_j[i]
$$</p>
<pre><code>where `Cj` is the coefficient vector for the j-th equation.
</code></pre>
<h4 id="memory-addressing">Memory Addressing</h4>
<ul>
<li>The coefficient vectors are stored sequentially in memory:
<ul>
<li><code>C₀</code> starts at <code>memory[4096]</code></li>
<li><code>C₁</code> starts at <code>memory[4100]</code></li>
<li>&hellip;</li>
<li><code>C₄₈</code> starts at <code>memory[4288]</code></li>
</ul>
</li>
</ul>
<p>This structure ensures that all 49 equations can be efficiently computed using the stored coefficients.</p>
<h4 id="observations-target-values-extraction">Observations## Target Values Extraction</h4>
<p>After decrypting the bytecode, we need to find the target values that the VM is checking against. The assembly shows a pattern of comparisons:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">67774: LOAD     TTTTTTGTTT (4096) [nm: A=2,T=0,G=1,C=3]
67786: PUSH     TCATCCTAAA (692012) [nm: A=2,T=0,G=1,C=3]
67798: EQ [nm: A=2,T=0,G=1,C=3]
67800: LOAD     TGTTTTGTTT (4100) [nm: A=2,T=0,G=1,C=3]
67812: PUSH     AGGCATGGGA (611030) [nm: A=2,T=0,G=1,C=3]
67824: EQ [nm: A=2,T=0,G=1,C=3]
</code></pre><p><em>&hellip; (continuing with similar patterns) &hellip;</em></p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">68996: LOAD     TCCATTGTTT (4284) [nm: A=2,T=0,G=1,C=3]
69008: PUSH     AAACAGATAA (665322) [nm: A=2,T=0,G=1,C=3]
69020: EQ [nm: A=2,T=0,G=1,C=3]
69022: LOAD     TTTCTTGTTT (4288) [nm: A=2,T=0,G=1,C=3]
69034: PUSH     GATATAGCAA (710793) [nm: A=2,T=0,G=1,C=3]
69046: EQ [nm: A=2,T=0,G=1,C=3]
</code></pre><p>The pattern shows:</p>
<ol>
<li><code>LOAD</code> instruction loads a value from memory at the specified address</li>
<li><code>PUSH</code> instruction pushes a target value onto the stack</li>
<li><code>EQ</code> compares the two values and pushes 1 if equal, 0 otherwise</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>target_values <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4096</span>: <span style="color:#ae81ff">692012</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4100</span>: <span style="color:#ae81ff">611030</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4104</span>: <span style="color:#ae81ff">658676</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4108</span>: <span style="color:#ae81ff">556679</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4112</span>: <span style="color:#ae81ff">588728</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4116</span>: <span style="color:#ae81ff">628470</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4120</span>: <span style="color:#ae81ff">659130</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4124</span>: <span style="color:#ae81ff">623012</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4128</span>: <span style="color:#ae81ff">590356</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4132</span>: <span style="color:#ae81ff">670831</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4136</span>: <span style="color:#ae81ff">734960</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4140</span>: <span style="color:#ae81ff">694096</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4144</span>: <span style="color:#ae81ff">673431</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4148</span>: <span style="color:#ae81ff">676517</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4152</span>: <span style="color:#ae81ff">638313</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4156</span>: <span style="color:#ae81ff">730305</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4160</span>: <span style="color:#ae81ff">651347</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4164</span>: <span style="color:#ae81ff">612947</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4168</span>: <span style="color:#ae81ff">614037</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4172</span>: <span style="color:#ae81ff">722768</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4176</span>: <span style="color:#ae81ff">662232</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4180</span>: <span style="color:#ae81ff">608720</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4184</span>: <span style="color:#ae81ff">598699</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4188</span>: <span style="color:#ae81ff">626932</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4192</span>: <span style="color:#ae81ff">659018</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4196</span>: <span style="color:#ae81ff">554138</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4200</span>: <span style="color:#ae81ff">627484</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4204</span>: <span style="color:#ae81ff">620929</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4208</span>: <span style="color:#ae81ff">655810</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4212</span>: <span style="color:#ae81ff">598103</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4216</span>: <span style="color:#ae81ff">664749</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4220</span>: <span style="color:#ae81ff">772833</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4224</span>: <span style="color:#ae81ff">710796</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4228</span>: <span style="color:#ae81ff">669747</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4232</span>: <span style="color:#ae81ff">576742</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4236</span>: <span style="color:#ae81ff">715958</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4240</span>: <span style="color:#ae81ff">682073</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4244</span>: <span style="color:#ae81ff">687276</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4248</span>: <span style="color:#ae81ff">806029</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4252</span>: <span style="color:#ae81ff">660519</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4256</span>: <span style="color:#ae81ff">728567</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4260</span>: <span style="color:#ae81ff">689664</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4264</span>: <span style="color:#ae81ff">746796</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4268</span>: <span style="color:#ae81ff">597800</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4272</span>: <span style="color:#ae81ff">629625</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4276</span>: <span style="color:#ae81ff">585142</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4280</span>: <span style="color:#ae81ff">678960</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4284</span>: <span style="color:#ae81ff">665322</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4288</span>: <span style="color:#ae81ff">710793</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="verification-logic">Verification Logic</h2>
<p>There are <strong>49 equality checks</strong> that compare loaded values with pushed values. Each comparison pushes either 1 (if equal) or 0 (if not equal) onto the stack.</p>
<p>After finishing all comparisons, the code adds all 49 values on the stack:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">69048: ADD [nm: A=2,T=0,G=1,C=3]
69050: ADD [nm: A=2,T=0,G=1,C=3]
69052: ADD [nm: A=2,T=0,G=1,C=3]
69054: ADD [nm: A=2,T=0,G=1,C=3]
69056: ADD [nm: A=2,T=0,G=1,C=3]
...
69138: ADD [nm: A=2,T=0,G=1,C=3]
69140: ADD [nm: A=2,T=0,G=1,C=3]
69142: ADD [nm: A=2,T=0,G=1,C=3]
</code></pre><p>If all comparisons return 1, then: <code>1 + 1 + 1 + ... + 1 = 49</code> (correct flag)<br>
Otherwise, the sum will be less than 49 (incorrect flag).</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">69144: PUSH     GTCTTTTTTT (49) [nm: A=2,T=0,G=1,C=3]
69156: EQ [nm: A=2,T=0,G=1,C=3]
69158: JNE      TCCAACTTGT (69308) [nm: A=2,T=0,G=1,C=3]
</code></pre><h2 id="output-messages">Output Messages</h2>
<h3 id="if-sum--49-jumps-to-69308">If sum ≠ 49 (jumps to 69308):</h3>
<p>Prints &ldquo;WRONG!&rdquo; - ASCII values <code>[87, 82, 79, 78, 71, 33]</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> k <span style="color:#f92672">=</span> [<span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">33</span>]
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join([chr(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> k])
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;WRONG!&#39;</span>
</span></span></code></pre></div><h3 id="if-sum--49">If sum = 49:</h3>
<p>Prints &ldquo;CORRECT!&rdquo; - ASCII values <code>[67, 79, 82, 82, 69, 67, 84, 33]</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> k <span style="color:#f92672">=</span> [<span style="color:#ae81ff">67</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">67</span>, <span style="color:#ae81ff">84</span>, <span style="color:#ae81ff">33</span>]
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join([chr(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> k])
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;CORRECT!&#39;</span>
</span></span></code></pre></div><h2 id="success-path-assembly">Success Path Assembly</h2>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">69170: PUSH     CTTGTTTTTT (67) [nm: A=2,T=0,G=1,C=3]   # &#39;C&#39;
69182: PRINT [nm: A=2,T=0,G=1,C=3]
69184: PUSH     CCTGTTTTTT (79) [nm: A=2,T=0,G=1,C=3]   # &#39;O&#39;
69196: PRINT [nm: A=2,T=0,G=1,C=3]
69198: PUSH     ATGGTTTTTT (82) [nm: A=2,T=0,G=1,C=3]   # &#39;R&#39;
69210: PRINT [nm: A=2,T=0,G=1,C=3]
69212: PUSH     ATGGTTTTTT (82) [nm: A=2,T=0,G=1,C=3]   # &#39;R&#39;
69224: PRINT [nm: A=2,T=0,G=1,C=3]
69226: PUSH     GGTGTTTTTT (69) [nm: A=2,T=0,G=1,C=3]   # &#39;E&#39;
69238: PRINT [nm: A=2,T=0,G=1,C=3]
69240: PUSH     CTTGTTTTTT (67) [nm: A=2,T=0,G=1,C=3]   # &#39;C&#39;
69252: PRINT [nm: A=2,T=0,G=1,C=3]
69254: PUSH     TGGGTTTTTT (84) [nm: A=2,T=0,G=1,C=3]   # &#39;T&#39;
69266: PRINT [nm: A=2,T=0,G=1,C=3]
69268: PUSH     GTATTTTTTT (33) [nm: A=2,T=0,G=1,C=3]   # &#39;!&#39;
69280: PRINT [nm: A=2,T=0,G=1,C=3]
69282: PUSH     AATTTTTTTT (10) [nm: A=2,T=0,G=1,C=3]   # &#39;\n&#39;
69294: PRINT [nm: A=2,T=0,G=1,C=3]
69296: JMP      ACGTCCTTGT (69406) [nm: A=2,T=0,G=1,C=3]
</code></pre><h2 id="failure-path-assembly">Failure Path Assembly</h2>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">69308: PUSH     CGGGTTTTTT (87) [nm: A=2,T=0,G=1,C=3]   # &#39;W&#39;
69320: PRINT [nm: A=2,T=0,G=1,C=3]
69322: PUSH     ATGGTTTTTT (82) [nm: A=2,T=0,G=1,C=3]   # &#39;R&#39;
69334: PRINT [nm: A=2,T=0,G=1,C=3]
69336: PUSH     CCTGTTTTTT (79) [nm: A=2,T=0,G=1,C=3]   # &#39;O&#39;
69348: PRINT [nm: A=2,T=0,G=1,C=3]
69350: PUSH     ACTGTTTTTT (78) [nm: A=2,T=0,G=1,C=3]   # &#39;N&#39;
69362: PRINT [nm: A=2,T=0,G=1,C=3]
69364: PUSH     CGTGTTTTTT (71) [nm: A=2,T=0,G=1,C=3]   # &#39;G&#39;
69376: PRINT [nm: A=2,T=0,G=1,C=3]
69378: PUSH     GTATTTTTTT (33) [nm: A=2,T=0,G=1,C=3]   # &#39;!&#39;
69390: PRINT [nm: A=2,T=0,G=1,C=3]
69392: PUSH     AATTTTTTTT (10) [nm: A=2,T=0,G=1,C=3]   # &#39;\n&#39;
69404: PRINT [nm: A=2,T=0,G=1,C=3]
69406: HALT [nm: A=2,T=0,G=1,C=3]
</code></pre><h1 id="solving-a-system-of-linear-equations">Solving a System of Linear Equations</h1>
<h2 id="problem-formulation">Problem Formulation</h2>
<p>We are given a system of equations of the form:
$$\sum_{j=0}^{48} \text{flag}[j] \cdot C_j[i] = m[i] \quad \text{for } i = 0, 1, \dots, 48$$</p>
<p>This can be interpreted as a matrix equation:
$$\mathbf{C} \cdot \mathbf{f} = \mathbf{m}$$</p>
<p>Where:</p>
<ul>
<li>$\mathbf{C}$ is a $49 \times 49$ matrix, with $C_j[i]$ representing the coefficient in row $i$, column $j$</li>
<li>$\mathbf{f}$ is a column vector of length 49 representing the flag values: $[\text{flag}[0], \text{flag}[1], \dots, \text{flag}[48]]^T$</li>
<li>$\mathbf{m}$ is the column vector of resulting values: $[m[0], m[1], \dots, m[48]]^T$</li>
</ul>
<h2 id="solution-methodology">Solution Methodology</h2>
<p><img src="./matrix.png" alt="image"></p>
<p><strong>to solve the System</strong>:
we now need to solve:</p>
<p>$$
\mathbf{C} \cdot \mathbf{f} = \mathbf{m}
$$</p>
<p>To find $\mathbf{f}$ (i.e., the flag):</p>
<ul>
<li><strong>Exact Arithmetic (e.g., Modular Inverse)</strong> :</li>
</ul>
<p>$$
\mathbf{f} = \mathbf{C}^{-1} \cdot \mathbf{m} \mod 256
$$</p>
<hr>
<h3 id="step-3-verify-system-solvability">Step 3: Verify System Solvability</h3>
<p>To ensure that the 49 equations are linearly independent, we verify the determinant of the coefficient matrix $\mathbf{C}$. If the determinant is non-zero, the system has a unique solution.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>det(A)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7.002684569518382e+123</span>
</span></span></code></pre></div><p>Since $\det(\mathbf{C}) \neq 0$, matrix $\mathbf{C}$ is invertible and the system can be solved directly.</p>
<h2 id="implementation">Implementation</h2>
<p>The following Python script solves the system:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Construct coefficient matrix and target vector</span>
</span></span><span style="display:flex;"><span>addrs <span style="color:#f92672">=</span> sorted(memory<span style="color:#f92672">.</span>keys())
</span></span><span style="display:flex;"><span>A <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>vstack([memory[a] <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> addrs])    
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([m[a] <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> addrs], dtype<span style="color:#f92672">=</span>float)  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Solve the linear system</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>solve(A, b)   
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Matrix A is invertible, proceeding with direct solve.&#34;</span>)
</span></span><span style="display:flex;"><span>    method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;direct solve&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>LinAlgError:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Fallback to least-squares if matrix is singular</span>
</span></span><span style="display:flex;"><span>    f, residuals, rank, s <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>lstsq(A, b, rcond<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>    method <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;least-squares (rank </span><span style="color:#e6db74">{</span>rank<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert to integer values</span>
</span></span><span style="display:flex;"><span>f_int <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>rint(f)<span style="color:#f92672">.</span>astype(int)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Display results</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Solution method: </span><span style="color:#e6db74">{</span>method<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Flag bytes:&#34;</span>, f_int<span style="color:#f92672">.</span>tolist())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;As ASCII:&#34;</span>, <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(chr(v) <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> f_int))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;residuals&#39;</span> <span style="color:#f92672">in</span> locals():
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Residual norm²:&#34;</span>, residuals)
</span></span></code></pre></div><h2 id="results">Results</h2>
<p>The solution yields the following flag values:</p>
<p><strong>Flag bytes</strong>: <code>[119, 101, 95, 111, 117, 103, 104, 116, 95, 116, 111, 95, 115, 116, 97, 114, 116, 95, 115, 116, 111, 114, 105, 110, 103, 95, 111, 117, 114, 95, 100, 97, 116, 97, 95, 97, 115, 95, 100, 110, 97, 95, 105, 110, 115, 116, 101, 97, 100]</code></p>
<p><strong>ASCII representation</strong>: <code>we_ought_to_start_storing_our_data_as_dna_instead</code></p>
<p>The direct matrix solution method successfully recovered the flag, demonstrating that the system was well-conditioned and had a unique solution.</p>

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="//localhost:1313/posts/apocalypse-htb/gateway/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>Rev/gateway</a>
        
	    
            <div class="next-post">
                <a href="//localhost:1313/posts/tamu2025/xorox/?ref=footer"><span style="font-weight:bold;">Next »</span><br>xorox</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#revdna">rev/DNA</a></li>
    <li><a href="#flag--we_ought_to_start_storing_our_data_as_dna_instead">Flag : .;,;.{we_ought_to_start_storing_our_data_as_dna_instead}</a></li>
  </ul>

  <ul>
    <li><a href="#initial-recon">Initial Recon</a>
      <ul>
        <li><a href="#what-is-a-vm">What Is A VM?</a></li>
        <li><a href="#how-do-virtual-machines-work">How Do Virtual Machines Work?</a></li>
        <li><a href="#the-fedex-loop">The FeDeX Loop</a></li>
        <li><a href="#starting-with-the-challenge">Starting with the Challenge</a></li>
        <li><a href="#virtual-machine-overview">Virtual Machine Overview</a></li>
        <li><a href="#beginning-execution">Beginning Execution</a></li>
        <li><a href="#opcode-interpretation">Opcode Interpretation</a></li>
        <li><a href="#brute-force-key-recovery">Brute Force Key Recovery</a></li>
      </ul>
    </li>
    <li><a href="#systematic-approach">Systematic Approach</a></li>
    <li><a href="#decompiled-python-code-from-unlucky-bytecode">Decompiled Python Code from <code>unlucky</code> Bytecode</a>
      <ul>
        <li><a href="#unlucky0">unlucky[0]</a></li>
        <li><a href="#unlucky1">unlucky[1]</a></li>
        <li><a href="#unlucky2">unlucky[2]</a></li>
        <li><a href="#unlucky3">unlucky[3]</a></li>
      </ul>
    </li>
    <li><a href="#output">Output</a></li>
    <li><a href="#explanation">Explanation</a>
      <ul>
        <li><a href="#next-steps">Next Steps</a></li>
        <li><a href="#coefficient-vectors-cj">Coefficient Vectors (Cj)</a></li>
      </ul>
    </li>
    <li><a href="#verification-logic">Verification Logic</a></li>
    <li><a href="#output-messages">Output Messages</a>
      <ul>
        <li><a href="#if-sum--49-jumps-to-69308">If sum ≠ 49 (jumps to 69308):</a></li>
        <li><a href="#if-sum--49">If sum = 49:</a></li>
      </ul>
    </li>
    <li><a href="#success-path-assembly">Success Path Assembly</a></li>
    <li><a href="#failure-path-assembly">Failure Path Assembly</a></li>
  </ul>

  <ul>
    <li><a href="#problem-formulation">Problem Formulation</a></li>
    <li><a href="#solution-methodology">Solution Methodology</a>
      <ul>
        <li><a href="#step-3-verify-system-solvability">Step 3: Verify System Solvability</a></li>
      </ul>
    </li>
    <li><a href="#implementation">Implementation</a></li>
    <li><a href="#results">Results</a></li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
